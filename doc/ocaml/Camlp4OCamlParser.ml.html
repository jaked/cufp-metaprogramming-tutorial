<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.37 in css mode. -->
<html>
  <head>
    <title>Camlp4OCamlParser.ml</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <pre>
<span class="tuareg-font-lock-governing">open</span> <span class="type">Camlp4</span><span class="tuareg-font-lock-operator">;</span>                                        <span class="comment">(* -*- camlp4r -*- *)</span>
<span class="comment">(****************************************************************************)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(*                              Objective Caml                              *)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(*                            INRIA Rocquencourt                            *)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(*  Copyright 2002-2006 Institut National de Recherche en Informatique et   *)</span>
<span class="comment">(*  en Automatique.  All rights reserved.  This file is distributed under   *)</span>
<span class="comment">(*  the terms of the GNU Library General Public License, with the special   *)</span>
<span class="comment">(*  exception on linking described in LICENSE at the top of the Objective   *)</span>
<span class="comment">(*  Caml source tree.                                                       *)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(****************************************************************************)</span>

<span class="comment">(* Authors:
 * - Daniel de Rauglaudre: initial version
 * - Nicolas Pouillard: refactoring
 *)</span>


<span class="tuareg-font-lock-governing">module</span> <span class="type">Id </span><span class="tuareg-font-lock-operator">:</span> <span class="type">Sig.Id </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-governing">struct</span>
  value name <span class="tuareg-font-lock-operator">=</span> <span class="string">"Camlp4OCamlParser"</span><span class="tuareg-font-lock-operator">;</span>
  value version <span class="tuareg-font-lock-operator">=</span> <span class="type">Sys</span>.ocaml_version<span class="tuareg-font-lock-operator">;</span>
<span class="tuareg-font-lock-governing">end</span><span class="tuareg-font-lock-operator">;</span>

<span class="tuareg-font-lock-governing">module</span> <span class="type">Make </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">Syntax</span> <span class="tuareg-font-lock-operator">:</span> <span class="type">Sig.Camlp4Syntax</span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-governing">struct</span>
  <span class="tuareg-font-lock-governing">open</span> <span class="type">Sig</span><span class="tuareg-font-lock-operator">;</span>
  <span class="tuareg-font-lock-governing">include</span> <span class="type">Syntax</span><span class="tuareg-font-lock-operator">;</span>

  <span class="type">Camlp4_config</span>.constructors_arity.<span class="tuareg-font-lock-governing">val</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">:=</span> False<span class="tuareg-font-lock-operator">;</span>

  <span class="comment">(*FIXME remove this and use OCaml ones *)</span>
  value bigarray_set _loc var newval <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">match</span> var <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array1</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array1</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array2</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array2</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array3</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array3</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Genarray</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>coords<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Genarray</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>coords<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> None <span class="tuareg-font-lock-operator">];</span>
  value mk_anti <span class="tuareg-font-lock-operator">?(</span>c <span class="tuareg-font-lock-operator">=</span> <span class="string">""</span><span class="tuareg-font-lock-operator">)</span> n s <span class="tuareg-font-lock-operator">=</span> <span class="string">"\\$"</span><span class="tuareg-font-lock-operator">^</span>n<span class="tuareg-font-lock-operator">^</span>c<span class="tuareg-font-lock-operator">^</span><span class="string">":"</span><span class="tuareg-font-lock-operator">^</span>s<span class="tuareg-font-lock-operator">;</span>
  <span class="comment">(*FIXME*)</span>

  value conc_seq e1 e2 <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">match</span> <span class="tuareg-font-lock-operator">(</span>e1<span class="tuareg-font-lock-operator">,</span> e2<span class="tuareg-font-lock-operator">)</span> <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">@</span>_loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">@</span>_loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;,</span> _<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">(</span>_<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">@</span>_loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">_loc </span><span class="tuareg-font-lock-operator">=</span>
          <span class="type">Loc</span>.merge <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.loc_of_expr e1<span class="tuareg-font-lock-operator">)</span>
                    <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.loc_of_expr e2<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">];</span>

  value stream_peek_nth n strm <span class="tuareg-font-lock-operator">=</span>
    loop n <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.npeek n strm<span class="tuareg-font-lock-operator">)</span> where <span class="tuareg-font-lock-governing">rec</span> loop n <span class="tuareg-font-lock-operator">=</span>
      <span class="keyword">fun</span>
     <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">-&gt;</span> None
      <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[(</span>x<span class="tuareg-font-lock-operator">,</span> _<span class="tuareg-font-lock-operator">)]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">if</span> n <span class="tuareg-font-lock-operator">==</span> 1 <span class="keyword">then</span> Some x <span class="keyword">else</span> None
      <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[</span>_ <span class="tuareg-font-lock-operator">::</span> l<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> loop <span class="tuareg-font-lock-operator">(</span>n <span class="tuareg-font-lock-operator">-</span> 1<span class="tuareg-font-lock-operator">)</span> l <span class="tuareg-font-lock-operator">]</span>
  <span class="tuareg-font-lock-operator">;</span>

  value test_not_dot_nor_lparen <span class="tuareg-font-lock-operator">=</span>
    <span class="type">Gram</span>.<span class="type">Entry</span>.of_parser <span class="string">"test_not_dot_nor_lparen"</span> <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">strm </span><span class="tuareg-font-lock-operator">-&gt;</span>
      <span class="keyword">match</span> <span class="type">Stream</span>.peek strm <span class="keyword">with</span>
      <span class="tuareg-font-lock-operator">[</span> Some <span class="tuareg-font-lock-operator">(</span>KEYWORD <span class="tuareg-font-lock-operator">(</span><span class="string">"."</span><span class="tuareg-font-lock-operator">|</span><span class="string">"("</span><span class="tuareg-font-lock-operator">),</span>_<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="type">Stream</span>.Failure
      <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]);</span>

  value <span class="tuareg-font-lock-governing">rec</span> is_ident_constr_call <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">fun</span>
   <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">_</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> True</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$.$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span> is_ident_constr_call i
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> False <span class="tuareg-font-lock-operator">];</span>

  value <span class="tuareg-font-lock-governing">rec</span> is_expr_constr_call <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">fun</span>
   <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> is_ident_constr_call i</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span> True
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$.$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span> is_expr_constr_call e
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">@</span>_loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">res </span><span class="tuareg-font-lock-operator">=</span> is_expr_constr_call e <span class="tuareg-font-lock-governing">in</span>
        <span class="keyword">if</span> <span class="tuareg-font-lock-operator">(not</span> <span class="type">Camlp4_config</span>.constructors_arity.<span class="tuareg-font-lock-governing">val</span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span> res <span class="keyword">then</span>
          <span class="type">Loc</span>.<span class="keyword">raise</span> _loc <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error <span class="string">"currified constructor"</span><span class="tuareg-font-lock-operator">)</span>
        <span class="keyword">else</span> res
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> False <span class="tuareg-font-lock-operator">];</span>

  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"where"</span><span class="tuareg-font-lock-operator">;</span> opt_rec<span class="tuareg-font-lock-operator">;</span> let_binding END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">value_let</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"value"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">value_val</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"value"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">str_item</span><span class="tuareg-font-lock-operator">:</span> <span class="type">value_let</span><span class="tuareg-font-lock-operator">;</span> opt_rec<span class="tuareg-font-lock-operator">;</span> binding END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">module_type</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> a_ident END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">module_type</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> dummy END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">module_type</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">label_expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">label_longident</span><span class="tuareg-font-lock-operator">;</span> fun_binding END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">meth_list</span><span class="tuareg-font-lock-operator">:</span> <span class="type">meth_decl</span><span class="tuareg-font-lock-operator">;</span> opt_dot_dot END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> opt_rec<span class="tuareg-font-lock-operator">;</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> module_binding0<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"fun"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> LIST0 match_case0 SEP <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"if"</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"then"</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"else"</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"do"</span><span class="tuareg-font-lock-operator">;</span> do_sequence END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"new"</span><span class="tuareg-font-lock-operator">;</span> class_longident END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> sem_expr_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"::"</span><span class="tuareg-font-lock-operator">;</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> label_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span><span class="tuareg-font-lock-operator">;</span> label_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> comma_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> dummy END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  <span class="comment">(* Some other DELETE_RULE are after the grammar *)</span>

  value clear <span class="tuareg-font-lock-operator">=</span> <span class="type">Gram</span>.<span class="type">Entry</span>.clear<span class="tuareg-font-lock-operator">;</span>
  clear ctyp<span class="tuareg-font-lock-operator">;</span>
  clear patt<span class="tuareg-font-lock-operator">;</span>
  clear a_UIDENT<span class="tuareg-font-lock-operator">;</span>
  clear type_longident_and_parameters<span class="tuareg-font-lock-operator">;</span>
  clear type_parameters<span class="tuareg-font-lock-operator">;</span>
  clear ipatt<span class="tuareg-font-lock-operator">;</span>
  clear labeled_ipatt<span class="tuareg-font-lock-operator">;</span>
  clear semi<span class="tuareg-font-lock-operator">;</span>
  clear do_sequence<span class="tuareg-font-lock-operator">;</span>
  clear type_kind<span class="tuareg-font-lock-operator">;</span>
  clear constructor_arg_list<span class="tuareg-font-lock-operator">;</span>
  clear poly_type<span class="tuareg-font-lock-operator">;</span>
  clear class_name_and_param<span class="tuareg-font-lock-operator">;</span>
  clear class_longident_and_param<span class="tuareg-font-lock-operator">;</span>
  clear class_type_longident_and_param<span class="tuareg-font-lock-operator">;</span>
  clear class_type_plus<span class="tuareg-font-lock-operator">;</span>
  clear type_constraint<span class="tuareg-font-lock-operator">;</span>
  clear comma_patt<span class="tuareg-font-lock-operator">;</span>
  clear sequence<span class="tuareg-font-lock-operator">;</span>
  clear sem_expr_for_list<span class="tuareg-font-lock-operator">;</span>
  clear sem_expr<span class="tuareg-font-lock-operator">;</span>
  clear label_declaration<span class="tuareg-font-lock-operator">;</span>
  clear star_ctyp<span class="tuareg-font-lock-operator">;</span>
  clear match_case<span class="tuareg-font-lock-operator">;</span>
  clear with_constr<span class="tuareg-font-lock-operator">;</span>
  clear package_type<span class="tuareg-font-lock-operator">;</span>
  clear top_phrase<span class="tuareg-font-lock-operator">;</span>

  EXTEND Gram
    <span class="variable-name">GLOBAL</span><span class="tuareg-font-lock-operator">:</span>
      <span class="type">a_CHAR a_FLOAT a_INT a_INT32 a_INT64 a_LABEL a_LIDENT</span>
      a_NATIVEINT a_OPTLABEL a_STRING a_UIDENT a_ident
      amp_ctyp and_ctyp match_case match_case0 match_case_quot binding binding_quot
      class_declaration class_description class_expr class_expr_quot
      class_fun_binding class_fun_def class_info_for_class_expr
      class_info_for_class_type class_longident class_longident_and_param
      class_name_and_param class_sig_item class_sig_item_quot class_signature
      class_str_item class_str_item_quot class_structure class_type
      class_type_declaration class_type_longident
      class_type_longident_and_param class_type_plus class_type_quot
      comma_ctyp comma_expr comma_ipatt comma_patt comma_type_parameter
      constrain constructor_arg_list constructor_declaration
      constructor_declarations ctyp ctyp_quot cvalue_binding direction_flag
      dummy eq_expr expr expr_eoi expr_quot fun_binding
      fun_def ident ident_quot implem interf ipatt ipatt_tcon label
      label_declaration label_declaration_list label_expr label_expr_list
      label_longident label_patt_list meth_list
      labeled_ipatt let_binding module_binding module_binding0
      module_binding_quot module_declaration module_expr module_expr_quot
      module_longident module_longident_with_app module_rec_declaration
      module_type module_type_quot more_ctyp name_tags opt_as_lident
      opt_class_self_patt opt_class_self_type
      opt_comma_ctyp opt_dot_dot opt_eq_ctyp opt_expr
      opt_meth_list opt_mutable opt_polyt opt_private opt_rec
      opt_virtual opt_when_expr patt patt_as_patt_opt patt_eoi
      patt_quot patt_tcon phrase poly_type row_field
      sem_expr sem_expr_for_list sem_patt sem_patt_for_list semi sequence
      sig_item sig_item_quot sig_items star_ctyp str_item str_item_quot
      str_items top_phrase type_constraint type_declaration
      type_ident_and_parameters type_kind type_longident
      type_longident_and_parameters type_parameter type_parameters typevars
      use_file val_longident value_let value_val with_constr with_constr_quot
      infixop0 infixop1 infixop2 infixop3 infixop4 do_sequence package_type
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sem_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sequence</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e <span class="tuareg-font-lock-operator">=</span> sem_expr <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">do_sequence</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> seq <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"done"</span> <span class="tuareg-font-lock-operator">-&gt;</span> seq
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sem_expr_for_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>el acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">str_item</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span>
          <span class="tuareg-font-lock-operator">[</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> r <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">r</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
          <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> r <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding <span class="tuareg-font-lock-operator">-&gt;</span>
              <span class="keyword">match</span> bi <span class="keyword">with</span>
              <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;</span> _ <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>exp<span class="tuareg-font-lock-operator">:</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
              <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-operator">$</span>rec<span class="tuareg-font-lock-operator">:</span><span class="type">r</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span>
          <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding0<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
          <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">open</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">seq_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            conc_seq e1 e2
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e1
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e1 <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">BEFORE </span><span class="string">"top"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">[</span> e <span class="tuareg-font-lock-operator">=</span> seq_expr <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"top"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> r <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span>
          x <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">r</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding0<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span>
          e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">open</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"function"</span><span class="tuareg-font-lock-operator">;</span> a <span class="tuareg-font-lock-operator">=</span> match_case <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>a<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"if"</span><span class="tuareg-font-lock-operator">;</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"then"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span><span class="tuareg-font-lock-operator">;</span>
          <span class="string">"else"</span><span class="tuareg-font-lock-operator">;</span> e3 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">if</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">then</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="keyword">else</span> <span class="tuareg-font-lock-operator">$</span>e3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"if"</span><span class="tuareg-font-lock-operator">;</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"then"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">if</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">then</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="keyword">else</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">BEFORE </span><span class="string">"||"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">","</span>
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> comma_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">":="</span> NONA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$.</span><span class="tuareg-font-lock-governing">val</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"&lt;-"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">match</span> bigarray_set _loc e1 e2 <span class="keyword">with</span>
            <span class="tuareg-font-lock-operator">[</span> Some e <span class="tuareg-font-lock-operator">-&gt;</span> e
            <span class="tuareg-font-lock-operator">|</span> None <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">AFTER </span><span class="string">"^"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"::"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"::"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"apply"</span> <span class="comment">(* LEFTA *)</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">match</span> <span class="tuareg-font-lock-operator">(</span>is_expr_constr_call e1<span class="tuareg-font-lock-operator">,</span> e2<span class="tuareg-font-lock-operator">)</span> <span class="keyword">with</span>
            <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">(</span>True<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>tup<span class="tuareg-font-lock-operator">:</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span> <span class="tuareg-font-lock-operator">-&gt;</span>
                <span class="type">List</span>.fold_left <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">e1 e2 </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span> e1
                                <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.list_of_expr e <span class="tuareg-font-lock-operator">[])</span>
            <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"simple"</span> <span class="comment">(* LEFTA *)</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"false"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> False <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"true"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> True <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> lel <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>lel <span class="tuareg-font-lock-operator">=</span> label_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> lel<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>lel<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e<span class="tuareg-font-lock-operator">];</span> lel <span class="tuareg-font-lock-operator">=</span> label_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$)</span> <span class="keyword">with</span> <span class="tuareg-font-lock-operator">$</span>lel<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"new"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">new</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">val_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$.$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">j</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">match_case</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> LIST1 match_case0 SEP <span class="string">"|"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.mcOr_of_list l <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">patt_constr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> module_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="comment">(* Patterns *)</span>
    <span class="variable-name">patt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"as"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">as</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"|"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">","</span>
        <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> <span class="comment">(*FIXME comma_patt*)</span> LIST1 NEXT SEP <span class="string">","</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>Ast.paCom_of_list pl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"::"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"::"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> patt_constr<span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">match</span> p2 <span class="keyword">with</span>
            <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>tup<span class="tuareg-font-lock-operator">:</span><span class="type">p</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
                <span class="type">List</span>.fold_left <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">p1 p2 </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span> p1
                                <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.list_of_patt p <span class="tuareg-font-lock-operator">[])</span>
            <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"lazy"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">lazy</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"pat"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt_constr <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"pat"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"tup"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>tup<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"`bool"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.patt_tag
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT32 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT64 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_NATIVEINT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_INT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="string">"-"</span> <span class="tuareg-font-lock-operator">^</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_INT32 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="string">"-"</span> <span class="tuareg-font-lock-operator">^</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_INT64 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="string">"-"</span> <span class="tuareg-font-lock-operator">^</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_NATIVEINT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="string">"-"</span> <span class="tuareg-font-lock-operator">^</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_FLOAT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="string">"-"</span> <span class="tuareg-font-lock-operator">^</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_FLOAT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_STRING <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>str<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s1 <span class="tuareg-font-lock-operator">=</span> a_CHAR<span class="tuareg-font-lock-operator">;</span> <span class="string">".."</span><span class="tuareg-font-lock-operator">;</span> s2 <span class="tuareg-font-lock-operator">=</span> a_CHAR <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>chr<span class="tuareg-font-lock-operator">:</span><span class="type">s1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">..</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">chr</span><span class="tuareg-font-lock-operator">:</span>s2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_CHAR <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>chr<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"false"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> False <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"true"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> True <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> mk_list <span class="tuareg-font-lock-operator">=</span> sem_patt_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"::"</span><span class="tuareg-font-lock-operator">;</span> last <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk_list last
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> mk_list <span class="tuareg-font-lock-operator">=</span> sem_patt_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk_list <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[|"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"|]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[||]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[|"</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> sem_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"|]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> label_patt_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"_"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> ` <span class="tuareg-font-lock-operator">$</span>s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">comma_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">":="</span> <span class="tuareg-font-lock-operator">-&gt;</span> e1 <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="comment">(* comma_patt:
      [ [ p1 = SELF; ","; p2 = SELF -&gt; &lt;:patt&lt; $p1$, $p2$ &gt;&gt;
        | p = patt LEVEL ".." -&gt; p ] ]
    ;                                                           *)</span>
    <span class="variable-name">type_constraint</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"constraint"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">with_constr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> wc1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> wc2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>wc1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">wc2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"with_constr"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"with_constr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.with_constr_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> opt_private_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">anti</span><span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> type_longident_and_parameters<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> opt_private_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> i1 <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> i2 <span class="tuareg-font-lock-operator">=</span> module_longident_with_app <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>i2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> opt_private_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">anti</span><span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> type_longident_and_parameters<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> opt_private_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> i1 <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> i2 <span class="tuareg-font-lock-operator">=</span> module_longident_with_app <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>i2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">package_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> module_longident_with_app <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> module_longident_with_app<span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span><span class="tuareg-font-lock-operator">;</span> cs <span class="tuareg-font-lock-operator">=</span> package_type_cstrs <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="keyword">with</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">cs</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">package_type_cstr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> ty <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">lid</span><span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>ty<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">package_type_cstrs</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> c <span class="tuareg-font-lock-operator">=</span> package_type_cstr <span class="tuareg-font-lock-operator">-&gt;</span> c
        <span class="tuareg-font-lock-operator">|</span> c <span class="tuareg-font-lock-operator">=</span> package_type_cstr<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> cs <span class="tuareg-font-lock-operator">=</span> package_type_cstrs <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>c<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">cs</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_private_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"private"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">private</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_plus</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span> <span class="tuareg-font-lock-operator">-&gt;</span> i<span class="tuareg-font-lock-operator">];</span> t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ct<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ct<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> OPTLABEL <span class="comment">(* FIXME inline a_OPTLABEL *)</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ct<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t<span class="tuareg-font-lock-operator">];</span> ct <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ct<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ct <span class="tuareg-font-lock-operator">=</span> TRY class_type <span class="tuareg-font-lock-operator">-&gt;</span> ct <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_longident_and_param</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> comma_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> class_type_longident <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> class_type_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_longident_and_param</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> comma_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span><span class="tuareg-font-lock-operator">;</span> ci <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">ci</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ci <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">ci</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_name_and_param</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> comma_type_parameter<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> x<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;)</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">as</span> <span class="tuareg-font-lock-operator">'$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"arrow"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span> <span class="tuareg-font-lock-operator">-&gt;</span> i<span class="tuareg-font-lock-operator">];</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"star"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"star"</span>
        <span class="tuareg-font-lock-operator">[</span> t <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"*"</span><span class="tuareg-font-lock-operator">;</span> tl <span class="tuareg-font-lock-operator">=</span> star_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">*</span> <span class="tuareg-font-lock-operator">$</span>tl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"ctyp1"</span>
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"ctyp2"</span>
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">try</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">Ast.ident_of_ctyp t1</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">Ast</span>.ident_of_ctyp t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
            <span class="keyword">with</span> <span class="tuareg-font-lock-operator">[</span> Invalid_argument s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error s<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">t </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-governing">in</span>
            <span class="keyword">try</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">Ast.ident_of_ctyp t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
            <span class="keyword">with</span> <span class="tuareg-font-lock-operator">[</span> Invalid_argument s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error s<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">'$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"_"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"tup"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>tup<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"id"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> mk <span class="tuareg-font-lock-operator">=</span> comma_ctyp_app<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span>
          i <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"ctyp2"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"&lt;"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> opt_meth_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[&lt;"</span><span class="tuareg-font-lock-operator">;</span> OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[&lt;"</span><span class="tuareg-font-lock-operator">;</span> OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> ntl <span class="tuareg-font-lock-operator">=</span> name_tags<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$</span>ntl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> package_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">meth_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> m <span class="tuareg-font-lock-operator">=</span> meth_decl <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>m<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">row_var_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">comma_ctyp_app</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> t2 <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">star_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp*"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"ctyp1"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"*"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">*</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"ctyp1"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">semi</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">";;"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_longident_and_parameters</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> tpl <span class="tuareg-font-lock-operator">=</span> type_parameters<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span>
            tpl <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> tp <span class="tuareg-font-lock-operator">=</span> type_parameter<span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">tp</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_parameters</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> type_parameter<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> t2 <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> type_parameter <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_ident_and_parameters</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> tpl <span class="tuareg-font-lock-operator">=</span> LIST1 type_parameter SEP <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> tpl<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> type_parameter<span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">[</span>t<span class="tuareg-font-lock-operator">])</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">[])</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_kind</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"private"</span><span class="tuareg-font-lock-operator">;</span> tk <span class="tuareg-font-lock-operator">=</span> type_kind <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">private</span> <span class="tuareg-font-lock-operator">$</span>tk<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_declarations<span class="tuareg-font-lock-operator">;</span>
                   test_not_dot_nor_lparen <span class="tuareg-font-lock-operator">-&gt;</span> t<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> TRY ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> TRY ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"private"</span><span class="tuareg-font-lock-operator">;</span> tk <span class="tuareg-font-lock-operator">=</span> type_kind <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">==</span> <span class="keyword">private</span> <span class="tuareg-font-lock-operator">$</span>tk<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> TRY ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> label_declaration_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">==</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> TRY ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> OPT <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> constructor_declarations <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">==</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> label_declaration_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"apply"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ident_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"apply"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_longident_with_app</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"apply"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_longident</span><span class="tuareg-font-lock-operator">:</span> <span class="type">LEVEL </span><span class="string">"apply"</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">constructor_arg_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"*"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">t2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"ctyp1"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">value_let</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"let"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">value_val</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"val"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>  <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"mutable"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="keyword">mutable</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">poly_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>t <span class="tuareg-font-lock-operator">=</span> typevars<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span> <span class="tuareg-font-lock-operator">-&gt;</span> t<span class="tuareg-font-lock-operator">];</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">!</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> . <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> TRY ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">labeled_ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> a_LABEL<span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt LEVEL <span class="string">"simple"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">($</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="comment">(* ?a:b &lt;&gt; ?a : b *)</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">($</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">j</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">($</span><span class="type">p</span><span class="tuareg-font-lock-operator">$)</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span>
          e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt LEVEL <span class="string">"simple"</span> <span class="tuareg-font-lock-operator">-&gt;</span> p
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> label_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_UIDENT</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"uid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `UIDENT <span class="string">"True"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="string">" True"</span>
        <span class="tuareg-font-lock-operator">|</span> `UIDENT <span class="string">"False"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="string">" False"</span>
        <span class="tuareg-font-lock-operator">|</span> `UIDENT s <span class="tuareg-font-lock-operator">-&gt;</span> s
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">top_phrase</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";;"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> l <span class="tuareg-font-lock-operator">=</span> LIST1 str_item<span class="tuareg-font-lock-operator">;</span> <span class="string">";;"</span> <span class="tuareg-font-lock-operator">-&gt;</span> Some <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.stSem_of_list l<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> None
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
  END<span class="tuareg-font-lock-operator">;</span>

  <span class="comment">(* Some other DELETE_RULE are before the grammar *)</span>
  DELETE_RULE Gram <span class="variable-name">module_longident_with_app</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">type_longident</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">ident_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">module_longident_with_app</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">type_longident</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">ident_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
  DELETE_RULE Gram <span class="variable-name">module_expr</span><span class="tuareg-font-lock-operator">:</span> <span class="type">SELF</span><span class="tuareg-font-lock-operator">;</span> SELF END<span class="tuareg-font-lock-operator">;</span>
<span class="tuareg-font-lock-governing">end</span><span class="tuareg-font-lock-operator">;</span>
<span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> M </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Register</span>.OCamlSyntaxExtension Id Make <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">();</span>
</pre>
  </body>
</html>
