<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.37 in css mode. -->
<html>
  <head>
    <title>Camlp4OCamlRevisedParser.ml</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <pre>
<span class="tuareg-font-lock-governing">open</span> <span class="type">Camlp4</span><span class="tuareg-font-lock-operator">;</span>                                        <span class="comment">(* -*- camlp4r -*- *)</span>
<span class="comment">(****************************************************************************)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(*                              Objective Caml                              *)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(*                            INRIA Rocquencourt                            *)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(*  Copyright 2002-2006 Institut National de Recherche en Informatique et   *)</span>
<span class="comment">(*  en Automatique.  All rights reserved.  This file is distributed under   *)</span>
<span class="comment">(*  the terms of the GNU Library General Public License, with the special   *)</span>
<span class="comment">(*  exception on linking described in LICENSE at the top of the Objective   *)</span>
<span class="comment">(*  Caml source tree.                                                       *)</span>
<span class="comment">(*                                                                          *)</span>
<span class="comment">(****************************************************************************)</span>

<span class="comment">(* Authors:
 * - Daniel de Rauglaudre: initial version
 * - Nicolas Pouillard: refactoring
 *)</span>

<span class="tuareg-font-lock-governing">module</span> <span class="type">Id </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-governing">struct</span>
  value name <span class="tuareg-font-lock-operator">=</span> <span class="string">"Camlp4OCamlRevisedParser"</span><span class="tuareg-font-lock-operator">;</span>
  value version <span class="tuareg-font-lock-operator">=</span> <span class="type">Sys</span>.ocaml_version<span class="tuareg-font-lock-operator">;</span>
<span class="tuareg-font-lock-governing">end</span><span class="tuareg-font-lock-operator">;</span>

<span class="tuareg-font-lock-governing">module</span> <span class="type">Make </span><span class="tuareg-font-lock-operator">(</span><span class="variable-name">Syntax</span> <span class="tuareg-font-lock-operator">:</span> <span class="type">Sig.Camlp4Syntax</span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-governing">struct</span>
  <span class="tuareg-font-lock-governing">open</span> <span class="type">Sig</span><span class="tuareg-font-lock-operator">;</span>
  <span class="tuareg-font-lock-governing">include</span> <span class="type">Syntax</span><span class="tuareg-font-lock-operator">;</span>

  <span class="comment">(* Camlp4_config.constructors_arity.val := True; *)</span>
  <span class="type">Camlp4_config</span>.constructors_arity.<span class="tuareg-font-lock-governing">val</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">:=</span> False<span class="tuareg-font-lock-operator">;</span>

  value help_sequences <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span>
      <span class="type">Printf</span>.eprintf <span class="string">"\
New syntax:\n\
    (e1; e2; ... ; en) OR begin e1; e2; ... ; en end\n\
    while e do e1; e2; ... ; en done\n\
    for v = v1 to/downto v2 do e1; e2; ... ; en done\n\
Old syntax (still supported):\n\
    do {e1; e2; ... ; en}\n\
    while e do {e1; e2; ... ; en}\n\
    for v = v1 to/downto v2 do {e1; e2; ... ; en}\n\
Very old (no more supported) syntax:\n\
    do e1; e2; ... ; en-1; return en\n\
    while e do e1; e2; ... ; en; done\n\
    for v = v1 to/downto v2 do e1; e2; ... ; en; done\n\
  "</span><span class="tuareg-font-lock-operator">;</span>
      flush stderr<span class="tuareg-font-lock-operator">;</span>
      <span class="keyword">exit</span> 1
    <span class="tuareg-font-lock-operator">}</span>
  <span class="tuareg-font-lock-operator">;</span>
  <span class="type">Options</span>.add <span class="string">"-help_seq"</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Arg</span>.Unit help_sequences<span class="tuareg-font-lock-operator">)</span>
    <span class="string">"Print explanations about new sequences and exit."</span><span class="tuareg-font-lock-operator">;</span>

  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_CHAR<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_FLOAT<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_INT<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_INT32<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_INT64<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_LABEL<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_LIDENT<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_NATIVEINT<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_OPTLABEL<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_STRING<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_UIDENT<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear a_ident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear amp_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear and_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear match_case<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear match_case0<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear match_case_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear binding<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear binding_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear rec_binding_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_description<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_expr_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_fun_binding<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_fun_def<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_info_for_class_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_info_for_class_type<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_longident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_longident_and_param<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_name_and_param<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_sig_item<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_sig_item_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_signature<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_str_item<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_str_item_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_structure<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_type<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_type_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_type_longident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_type_longident_and_param<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_type_plus<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear class_type_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear comma_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear comma_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear comma_ipatt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear comma_patt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear comma_type_parameter<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear constrain<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear constructor_arg_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear constructor_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear constructor_declarations<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear ctyp_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear cvalue_binding<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear direction_flag<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear dummy<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear eq_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear expr_eoi<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear expr_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear field_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear field_expr_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear fun_binding<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear fun_def<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear ident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear ident_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear implem<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear interf<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear ipatt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear ipatt_tcon<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_declaration_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_expr_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_ipatt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_ipatt_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_longident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_patt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear label_patt_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear labeled_ipatt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear let_binding<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear meth_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear meth_decl<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_binding<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_binding0<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_binding_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_expr_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_longident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_longident_with_app<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_rec_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_type<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear module_type_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear more_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear name_tags<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_as_lident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_class_self_patt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_class_self_type<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_comma_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_dot_dot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_eq_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_meth_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_mutable<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_polyt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_private<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_rec<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_virtual<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear opt_when_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear patt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear patt_as_patt_opt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear patt_eoi<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear patt_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear patt_tcon<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear phrase<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear poly_type<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear row_field<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sem_expr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sem_expr_for_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sem_patt<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sem_patt_for_list<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear semi<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sequence<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sig_item<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sig_item_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear sig_items<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear star_ctyp<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear str_item<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear str_item_quot<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear str_items<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear top_phrase<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_constraint<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_declaration<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_ident_and_parameters<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_kind<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_longident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_longident_and_parameters<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_parameter<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear type_parameters<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear typevars<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear use_file<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear val_longident<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear value_let<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear value_val<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear with_constr<span class="tuareg-font-lock-operator">;</span>
  <span class="type">Gram</span>.<span class="type">Entry</span>.clear with_constr_quot<span class="tuareg-font-lock-operator">;</span>

  value neg_string n <span class="tuareg-font-lock-operator">=</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">len </span><span class="tuareg-font-lock-operator">=</span> <span class="type">String</span>.length n <span class="tuareg-font-lock-governing">in</span>
    <span class="keyword">if</span> len <span class="tuareg-font-lock-operator">&gt;</span> 0 <span class="tuareg-font-lock-operator">&amp;&amp;</span> n.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">=</span> <span class="string">'-'</span> <span class="keyword">then</span> <span class="type">String</span>.sub n 1 <span class="tuareg-font-lock-operator">(</span>len <span class="tuareg-font-lock-operator">-</span> 1<span class="tuareg-font-lock-operator">)</span>
    <span class="keyword">else</span> <span class="string">"-"</span> <span class="tuareg-font-lock-operator">^</span> n
  <span class="tuareg-font-lock-operator">;</span>

  value mkumin _loc f arg <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">match</span> arg <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="type">n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="type">n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="type">n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="type">n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="type">n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string n</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="string">"~"</span> <span class="tuareg-font-lock-operator">^</span> f<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>arg<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">];</span>

  value mklistexp _loc last <span class="tuareg-font-lock-operator">=</span>
    loop True where <span class="tuareg-font-lock-governing">rec</span> loop top <span class="tuareg-font-lock-operator">=</span>
      <span class="keyword">fun</span>
     <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="keyword">match</span> last <span class="keyword">with</span>
          <span class="tuareg-font-lock-operator">[</span> Some e <span class="tuareg-font-lock-operator">-&gt;</span> e
          <span class="tuareg-font-lock-operator">|</span> None <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[</span>e1 <span class="tuareg-font-lock-operator">::</span> el<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">_loc </span><span class="tuareg-font-lock-operator">=</span>
            <span class="keyword">if</span> top <span class="keyword">then</span> _loc <span class="keyword">else</span> <span class="type">Loc</span>.merge <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.loc_of_expr e1<span class="tuareg-font-lock-operator">)</span> _loc
          <span class="tuareg-font-lock-governing">in</span>
          <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>loop False el<span class="tuareg-font-lock-operator">$]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
  <span class="tuareg-font-lock-operator">;</span>

  value mkassert _loc <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">fun</span>
   <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> False <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">assert</span> False <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="comment">(* this case takes care about
                                   the special assert false node *)</span>
    <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">assert</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
  <span class="tuareg-font-lock-operator">;</span>

  value append_eLem el e <span class="tuareg-font-lock-operator">=</span> el <span class="tuareg-font-lock-operator">@</span> <span class="tuareg-font-lock-operator">[</span>e<span class="tuareg-font-lock-operator">];</span>
  value mk_anti <span class="tuareg-font-lock-operator">?(</span>c <span class="tuareg-font-lock-operator">=</span> <span class="string">""</span><span class="tuareg-font-lock-operator">)</span> n s <span class="tuareg-font-lock-operator">=</span> <span class="string">"\\$"</span><span class="tuareg-font-lock-operator">^</span>n<span class="tuareg-font-lock-operator">^</span>c<span class="tuareg-font-lock-operator">^</span><span class="string">":"</span><span class="tuareg-font-lock-operator">^</span>s<span class="tuareg-font-lock-operator">;</span>

  value mksequence _loc <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">fun</span>
   <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">_</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="keyword">as</span><span class="type"> e </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span>
  <span class="tuareg-font-lock-operator">;</span>

  value mksequence<span class="tuareg-font-lock-operator">'</span> _loc <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">fun</span>
   <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="keyword">as</span> e <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span>
  <span class="tuareg-font-lock-operator">;</span>

  value <span class="tuareg-font-lock-governing">rec</span> lid_of_ident <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">fun</span>
   <span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> . <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span> lid_of_ident i
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">lid</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> lid</span>
    <span class="tuareg-font-lock-operator">|</span> _                     <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">assert</span> False <span class="tuareg-font-lock-operator">];</span>

  value module_type_app mt1 mt2 <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">match</span> <span class="tuareg-font-lock-operator">(</span>mt1<span class="tuareg-font-lock-operator">,</span> mt2<span class="tuareg-font-lock-operator">)</span> <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">@</span>_loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i2</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;)</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>i2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="type">Stream</span>.Failure <span class="tuareg-font-lock-operator">];</span>

  value module_type_acc mt1 mt2 <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">match</span> <span class="tuareg-font-lock-operator">(</span>mt1<span class="tuareg-font-lock-operator">,</span> mt2<span class="tuareg-font-lock-operator">)</span> <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">@</span>_loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i2</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;)</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i1<span class="tuareg-font-lock-operator">$.$</span>i2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="type">Stream</span>.Failure <span class="tuareg-font-lock-operator">];</span>

  value bigarray_get _loc arr arg <span class="tuareg-font-lock-operator">=</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">coords </span><span class="tuareg-font-lock-operator">=</span>
      <span class="keyword">match</span> arg <span class="keyword">with</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="type">Ast</span>.list_of_expr e1 <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.list_of_expr e2 <span class="tuareg-font-lock-operator">[])</span>
      <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">[</span>arg<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-governing">in</span>
    <span class="keyword">match</span> coords <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span>c1<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array1</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[</span>c1<span class="tuareg-font-lock-operator">;</span> c2<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array2</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[</span>c1<span class="tuareg-font-lock-operator">;</span> c2<span class="tuareg-font-lock-operator">;</span> c3<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array3</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="comment">(* | coords -&gt; &lt;:expr&lt; Bigarray.Genarray.get $arr$ [| $list:coords$ |] &gt;&gt; ] *)</span>
    <span class="tuareg-font-lock-operator">|</span> coords <span class="tuareg-font-lock-operator">-&gt;</span>
       <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Genarray</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>Ast.exSem_of_list coords<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">];</span>

  value bigarray_set _loc var newval <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">match</span> var <span class="keyword">with</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array1</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array1</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array2</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array2</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array3</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Array3</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>c3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Genarray</span>.get <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>coords<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        Some <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="type">Bigarray</span>.<span class="type">Genarray</span>.set <span class="tuareg-font-lock-operator">$</span>arr<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>coords<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">$</span>newval<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
    <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> None <span class="tuareg-font-lock-operator">];</span>

  value stopped_at _loc <span class="tuareg-font-lock-operator">=</span>
    Some <span class="tuareg-font-lock-operator">(</span><span class="type">Loc</span>.move_line 1 _loc<span class="tuareg-font-lock-operator">)</span> <span class="comment">(* FIXME be more precise *)</span><span class="tuareg-font-lock-operator">;</span>

  value symbolchar <span class="tuareg-font-lock-operator">=</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list </span><span class="tuareg-font-lock-operator">=</span>
      <span class="tuareg-font-lock-operator">[</span><span class="string">'$'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'!'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'%'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'&amp;'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'*'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'+'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'-'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'.'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'/'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">':'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'&lt;'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'='</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'&gt;'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'?'</span><span class="tuareg-font-lock-operator">;</span>
       <span class="string">'@'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'^'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'|'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'~'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'\\'</span><span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-governing">in</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">rec</span> <span class="function-name">loop</span><span class="variable-name"> s i </span><span class="tuareg-font-lock-operator">=</span>
      <span class="keyword">if</span> i <span class="tuareg-font-lock-operator">==</span> <span class="type">String</span>.length s <span class="keyword">then</span> True
      <span class="keyword">else</span> <span class="keyword">if</span> <span class="type">List</span>.mem s.<span class="tuareg-font-lock-operator">[</span>i<span class="tuareg-font-lock-operator">]</span> list <span class="keyword">then</span> loop s <span class="tuareg-font-lock-operator">(</span>i <span class="tuareg-font-lock-operator">+</span> 1<span class="tuareg-font-lock-operator">)</span>
      <span class="keyword">else</span> False
    <span class="tuareg-font-lock-governing">in</span>
    loop
  <span class="tuareg-font-lock-operator">;</span>

  value setup_op_parser entry p <span class="tuareg-font-lock-operator">=</span>
    <span class="type">Gram</span>.<span class="type">Entry</span>.setup_parser entry
      <span class="tuareg-font-lock-operator">(</span><span class="keyword">parser</span>
        <span class="tuareg-font-lock-operator">[:</span> `<span class="tuareg-font-lock-operator">(</span>KEYWORD x <span class="tuareg-font-lock-operator">|</span> SYMBOL x<span class="tuareg-font-lock-operator">,</span> ti<span class="tuareg-font-lock-operator">)</span> <span class="keyword">when</span> p <span class="variable-name">x</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">_loc </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Gram</span>.token_location ti <span class="tuareg-font-lock-governing">in</span>
          <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;);</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">'!'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'?'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'~'</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">excl </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">"!="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"??"</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  setup_op_parser prefixop
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">not</span> <span class="tuareg-font-lock-operator">(</span><span class="type">List</span>.mem x excl<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&gt;=</span> 2 <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              <span class="type">List</span>.mem x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> list <span class="tuareg-font-lock-operator">&amp;&amp;</span> symbolchar x 1<span class="tuareg-font-lock-operator">);</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list_ok </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">"&lt;"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&lt;="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&lt;&gt;"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"=="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"!="</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"$"</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list_first_char_ok </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">'='</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'&lt;'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'&gt;'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'|'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'&amp;'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'$'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'!'</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">excl </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">"&lt;-"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"||"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&amp;&amp;"</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  setup_op_parser infixop0
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span><span class="type">List</span>.mem x list_ok<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">||</span>
              <span class="tuareg-font-lock-operator">(not</span> <span class="tuareg-font-lock-operator">(</span><span class="type">List</span>.mem x excl<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&gt;=</span> 2 <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              <span class="type">List</span>.mem x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> list_first_char_ok <span class="tuareg-font-lock-operator">&amp;&amp;</span> symbolchar x 1<span class="tuareg-font-lock-operator">));</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">'@'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'^'</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  setup_op_parser infixop1
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&gt;=</span> 1 <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">List</span>.mem x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> list <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              symbolchar x 1<span class="tuareg-font-lock-operator">);</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">'+'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'-'</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  setup_op_parser infixop2
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="string">"-&gt;"</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&gt;=</span> 1 <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">List</span>.mem x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> list <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              symbolchar x 1<span class="tuareg-font-lock-operator">);</span>

  <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">list </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span><span class="string">'*'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'/'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'%'</span><span class="tuareg-font-lock-operator">;</span> <span class="string">'\\'</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-governing">in</span>
  setup_op_parser infixop3
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&gt;=</span> 1 <span class="tuareg-font-lock-operator">&amp;&amp;</span> <span class="type">List</span>.mem x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> list <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              <span class="tuareg-font-lock-operator">(</span>x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="string">'*'</span> <span class="tuareg-font-lock-operator">||</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&lt;</span> 2 <span class="tuareg-font-lock-operator">||</span> x.<span class="tuareg-font-lock-operator">[</span>1<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="string">'*'</span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              symbolchar x 1<span class="tuareg-font-lock-operator">);</span>

  setup_op_parser infixop4
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">x </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">String</span>.length x <span class="tuareg-font-lock-operator">&gt;=</span> 2 <span class="tuareg-font-lock-operator">&amp;&amp;</span> x.<span class="tuareg-font-lock-operator">[</span>0<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">==</span> <span class="string">'*'</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span> x.<span class="tuareg-font-lock-operator">[</span>1<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">==</span> <span class="string">'*'</span> <span class="tuareg-font-lock-operator">&amp;&amp;</span>
              symbolchar x 2<span class="tuareg-font-lock-operator">);</span>

  value <span class="tuareg-font-lock-governing">rec</span> infix_kwds_filter <span class="tuareg-font-lock-operator">=</span>
    <span class="keyword">parser</span>
    <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[:</span> `<span class="tuareg-font-lock-operator">((</span>KEYWORD <span class="string">"("</span><span class="tuareg-font-lock-operator">,</span> _<span class="tuareg-font-lock-operator">)</span> <span class="keyword">as</span> tok<span class="tuareg-font-lock-operator">);</span> <span class="variable-name">xs</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="keyword">match</span> xs <span class="keyword">with</span> <span class="keyword">parser</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[:</span> `<span class="tuareg-font-lock-operator">(</span>KEYWORD <span class="tuareg-font-lock-operator">(</span><span class="string">"mod"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"land"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lor"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lxor"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lsl"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lsr"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"asr"</span> <span class="keyword">as</span> i<span class="tuareg-font-lock-operator">),</span> _loc<span class="tuareg-font-lock-operator">);</span>
             `<span class="tuareg-font-lock-operator">(</span>KEYWORD <span class="string">")"</span><span class="tuareg-font-lock-operator">,</span> _<span class="tuareg-font-lock-operator">);</span> <span class="variable-name">xs</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
                <span class="tuareg-font-lock-operator">[:</span> `<span class="tuareg-font-lock-operator">(</span>LIDENT i<span class="tuareg-font-lock-operator">,</span> _loc<span class="tuareg-font-lock-operator">);</span> infix_kwds_filter <span class="variable-name">xs</span> <span class="tuareg-font-lock-operator">:]</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[:</span> <span class="type">xs </span><span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
                <span class="tuareg-font-lock-operator">[:</span> `tok<span class="tuareg-font-lock-operator">;</span> infix_kwds_filter <span class="variable-name">xs</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[:</span> `x<span class="tuareg-font-lock-operator">;</span> <span class="variable-name">xs</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">[:</span> `x<span class="tuareg-font-lock-operator">;</span> infix_kwds_filter <span class="variable-name">xs</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">];</span>

  <span class="type">Token</span>.<span class="type">Filter</span>.define_filter <span class="tuareg-font-lock-operator">(</span><span class="type">Gram</span>.get_filter <span class="tuareg-font-lock-operator">())</span>
    <span class="tuareg-font-lock-operator">(</span><span class="keyword">fun</span> <span class="variable-name">f strm </span><span class="tuareg-font-lock-operator">-&gt;</span> infix_kwds_filter <span class="tuareg-font-lock-operator">(</span>f strm<span class="tuareg-font-lock-operator">));</span>

  <span class="type">Gram</span>.<span class="type">Entry</span>.setup_parser sem_expr <span class="tuareg-font-lock-governing">begin</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">symb1 </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Gram</span>.parse_tokens_after_filter expr <span class="tuareg-font-lock-governing">in</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">symb </span><span class="tuareg-font-lock-operator">=</span>
      <span class="keyword">parser</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[:</span> `<span class="tuareg-font-lock-operator">(</span>ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">,</span> ti<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">_loc </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Gram</span>.token_location ti <span class="tuareg-font-lock-governing">in</span>
        <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"expr;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[:</span> <span class="type">a </span><span class="tuareg-font-lock-operator">=</span> <span class="variable-name">symb1</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span> a <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-governing">in</span>
    <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">rec</span> <span class="function-name">kont</span><span class="variable-name"> al </span><span class="tuareg-font-lock-operator">=</span>
      <span class="keyword">parser</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[:</span> `<span class="tuareg-font-lock-operator">(</span>KEYWORD <span class="string">";"</span><span class="tuareg-font-lock-operator">,</span> _<span class="tuareg-font-lock-operator">);</span> a <span class="tuareg-font-lock-operator">=</span> symb<span class="tuareg-font-lock-operator">;</span> <span class="variable-name">s</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span>
        <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">_loc </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Loc</span>.merge <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.loc_of_expr al<span class="tuareg-font-lock-operator">)</span>
                             <span class="tuareg-font-lock-operator">(</span><span class="type">Ast</span>.loc_of_expr a<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
        kont <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>al<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>a<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> s
      <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">[:</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span> al <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-governing">in</span>
    <span class="keyword">parser</span> <span class="tuareg-font-lock-operator">[:</span> <span class="type">a </span><span class="tuareg-font-lock-operator">=</span> symb<span class="tuareg-font-lock-operator">;</span> <span class="variable-name">s</span> <span class="tuareg-font-lock-operator">:]</span> <span class="tuareg-font-lock-operator">-&gt;</span> kont a s
  <span class="tuareg-font-lock-governing">end</span><span class="tuareg-font-lock-operator">;</span>

  EXTEND Gram
    <span class="variable-name">GLOBAL</span><span class="tuareg-font-lock-operator">:</span>
      <span class="type">a_CHAR a_FLOAT a_INT a_INT32 a_INT64 a_LABEL a_LIDENT rec_binding_quot</span>
      a_NATIVEINT a_OPTLABEL a_STRING a_UIDENT a_ident
      amp_ctyp and_ctyp match_case match_case0 match_case_quot binding binding_quot
      class_declaration class_description class_expr class_expr_quot
      class_fun_binding class_fun_def class_info_for_class_expr
      class_info_for_class_type class_longident class_longident_and_param
      class_name_and_param class_sig_item class_sig_item_quot class_signature
      class_str_item class_str_item_quot class_structure class_type
      class_type_declaration class_type_longident
      class_type_longident_and_param class_type_plus class_type_quot
      comma_ctyp comma_expr comma_ipatt comma_patt comma_type_parameter
      constrain constructor_arg_list constructor_declaration
      constructor_declarations ctyp ctyp_quot cvalue_binding direction_flag
      dummy eq_expr expr expr_eoi expr_quot field_expr field_expr_list fun_binding
      fun_def ident ident_quot implem interf ipatt ipatt_tcon label
      label_declaration label_declaration_list label_expr label_expr_list
      label_ipatt label_ipatt_list label_longident label_patt label_patt_list
      labeled_ipatt let_binding meth_list meth_decl module_binding module_binding0
      module_binding_quot module_declaration module_expr module_expr_quot
      module_longident module_longident_with_app module_rec_declaration
      module_type module_type_quot more_ctyp name_tags opt_as_lident
      opt_class_self_patt opt_class_self_type opt_comma_ctyp opt_dot_dot opt_eq_ctyp opt_expr
      opt_meth_list opt_mutable opt_polyt opt_private opt_rec
      opt_virtual opt_when_expr patt patt_as_patt_opt patt_eoi
      patt_quot patt_tcon phrase poly_type row_field
      sem_expr sem_expr_for_list sem_patt sem_patt_for_list semi sequence
      sig_item sig_item_quot sig_items star_ctyp str_item str_item_quot
      str_items top_phrase type_constraint type_declaration
      type_ident_and_parameters type_kind type_longident
      type_longident_and_parameters type_parameter type_parameters typevars
      use_file val_longident value_let value_val with_constr with_constr_quot
      infixop0 infixop1 infixop2 infixop3 infixop4 do_sequence package_type
      rec_flag_quot direction_flag_quot mutable_flag_quot private_flag_quot
      virtual_flag_quot row_var_flag_quot override_flag_quot<span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"functor"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span>
          me <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">functor</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"struct"</span><span class="tuareg-font-lock-operator">;</span> st <span class="tuareg-font-lock-operator">=</span> str_items<span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">struct</span> <span class="tuareg-font-lock-operator">$</span>st<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">end</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span>
        <span class="tuareg-font-lock-operator">[</span> me1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> me2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>me1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>me2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"mexp"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_expr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.module_expr_tag
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> module_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> value_val<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span>value <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> value_val<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> package_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span>value <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">str_item</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"exception"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">exception</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"exception"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_declaration<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">exception</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"external"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> sl <span class="tuareg-font-lock-operator">=</span> string_list <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">external</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>sl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"include"</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">include</span> <span class="tuareg-font-lock-operator">$</span><span class="type">me</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding0 <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"rec"</span><span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-governing">rec</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mb</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> module_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">open</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> td <span class="tuareg-font-lock-operator">=</span> type_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">td</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> value_let<span class="tuareg-font-lock-operator">;</span> r <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-operator">$</span>rec<span class="tuareg-font-lock-operator">:</span><span class="type">r</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"class"</span><span class="tuareg-font-lock-operator">;</span> cd <span class="tuareg-font-lock-operator">=</span> class_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">class</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">cd</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"class"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> ctd <span class="tuareg-font-lock-operator">=</span> class_type_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">class</span> <span class="tuareg-font-lock-governing">type</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">ctd</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"stri"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"str_item"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.str_item_tag
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>exp<span class="tuareg-font-lock-operator">:</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_binding0</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">functor</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>m<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_binding</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> b1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> b2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>b1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">b2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"module_binding"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> m<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n <span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.module_binding_tag
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>m<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"functor"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">functor</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"with"</span>
        <span class="tuareg-font-lock-operator">[</span> mt <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span><span class="tuareg-font-lock-operator">;</span> wc <span class="tuareg-font-lock-operator">=</span> with_constr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="keyword">with</span> <span class="tuareg-font-lock-operator">$</span>wc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span>
        <span class="tuareg-font-lock-operator">[</span> mt1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> mt2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> dummy <span class="tuareg-font-lock-operator">-&gt;</span> module_type_app mt1 mt2 <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"."</span>
        <span class="tuareg-font-lock-operator">[</span> mt1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> mt2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> module_type_acc mt1 mt2 <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"sig"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"sig"</span><span class="tuareg-font-lock-operator">;</span> sg <span class="tuareg-font-lock-operator">=</span> sig_items<span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">sig</span> <span class="tuareg-font-lock-operator">$</span>sg<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">end</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"mtyp"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_type"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.module_type_tag
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> module_longident_with_app <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sig_item</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"sigi"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"sig_item"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.sig_item_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"exception"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">exception</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"external"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> sl <span class="tuareg-font-lock-operator">=</span> string_list <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">external</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>sl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"include"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">include</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"rec"</span><span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_rec_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-governing">rec</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mb</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> module_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">open</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> type_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> value_val<span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"class"</span><span class="tuareg-font-lock-operator">;</span> cd <span class="tuareg-font-lock-operator">=</span> class_description <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">class</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">cd</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"class"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> ctd <span class="tuareg-font-lock-operator">=</span> class_type_declaration <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">class</span> <span class="tuareg-font-lock-governing">type</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">ctd</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">functor</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>mt<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_rec_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> m1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> m2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>m1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">m2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"module_binding"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.module_binding_tag
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>m<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">with_constr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> wc1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> wc2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>wc1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">wc2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"with_constr"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"with_constr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.with_constr_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">anti</span><span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> type_longident_and_parameters<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> i1 <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> i2 <span class="tuareg-font-lock-operator">=</span> module_longident_with_app <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>i2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">anti</span><span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> type_longident_and_parameters<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> i1 <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> i2 <span class="tuareg-font-lock-operator">=</span> module_longident_with_app <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">i1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>i2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> r <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">r</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding0<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">open</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"fun"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> a <span class="tuareg-font-lock-operator">=</span> LIST0 match_case0 SEP <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>list<span class="tuareg-font-lock-operator">:</span><span class="type">a</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"fun"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> fun_def <span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"match"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span><span class="tuareg-font-lock-operator">;</span> a <span class="tuareg-font-lock-operator">=</span> match_case <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">match</span> <span class="tuareg-font-lock-operator">$</span>mksequence<span class="tuareg-font-lock-operator">'</span> _loc e<span class="tuareg-font-lock-operator">$</span> <span class="keyword">with</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>a<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"try"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span><span class="tuareg-font-lock-operator">;</span> a <span class="tuareg-font-lock-operator">=</span> match_case <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">try</span> <span class="tuareg-font-lock-operator">$</span>mksequence<span class="tuareg-font-lock-operator">'</span> _loc e<span class="tuareg-font-lock-operator">$</span> <span class="keyword">with</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>a<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"if"</span><span class="tuareg-font-lock-operator">;</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"then"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"else"</span><span class="tuareg-font-lock-operator">;</span> e3 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">if</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">then</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="keyword">else</span> <span class="tuareg-font-lock-operator">$</span>e3<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"do"</span><span class="tuareg-font-lock-operator">;</span> seq <span class="tuareg-font-lock-operator">=</span> do_sequence <span class="tuareg-font-lock-operator">-&gt;</span> mksequence _loc seq
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"for"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e1 <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> df <span class="tuareg-font-lock-operator">=</span> direction_flag<span class="tuareg-font-lock-operator">;</span>
          e2 <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"do"</span><span class="tuareg-font-lock-operator">;</span> seq <span class="tuareg-font-lock-operator">=</span> do_sequence <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">for</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mksequence<span class="tuareg-font-lock-operator">'</span> _loc e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>to<span class="tuareg-font-lock-operator">:</span><span class="type">df</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">mksequence</span><span class="tuareg-font-lock-operator">'</span><span class="type"> _loc e2</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="keyword">do</span><span class="type"> </span><span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>seq<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"while"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"do"</span><span class="tuareg-font-lock-operator">;</span> seq <span class="tuareg-font-lock-operator">=</span> do_sequence <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">while</span> <span class="tuareg-font-lock-operator">$</span>mksequence<span class="tuareg-font-lock-operator">'</span> _loc e<span class="tuareg-font-lock-operator">$</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>seq<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"object"</span><span class="tuareg-font-lock-operator">;</span> csp <span class="tuareg-font-lock-operator">=</span> opt_class_self_patt<span class="tuareg-font-lock-operator">;</span> cst <span class="tuareg-font-lock-operator">=</span> class_structure<span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">object</span> <span class="tuareg-font-lock-operator">($</span>csp<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">$</span>cst<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">end</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"where"</span>
        <span class="tuareg-font-lock-operator">[</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"where"</span><span class="tuareg-font-lock-operator">;</span> rf <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> lb <span class="tuareg-font-lock-operator">=</span> let_binding <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">rf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">lb</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">":="</span> NONA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":="</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> dummy <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">match</span> bigarray_set _loc e1 e2 <span class="keyword">with</span>
            <span class="tuareg-font-lock-operator">[</span> Some e <span class="tuareg-font-lock-operator">-&gt;</span> e
            <span class="tuareg-font-lock-operator">|</span> None <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:=</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"||"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop6<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"&amp;&amp;"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop5<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"&lt;"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop0<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"^"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop1<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"+"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop2<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"*"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"land"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">land</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"lor"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">lor</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"lxor"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> lxor <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"mod"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">mod</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop3<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"**"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"asr"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">asr</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"lsl"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">lsl</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"lsr"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">lsr</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> op <span class="tuareg-font-lock-operator">=</span> infixop4<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>op<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"unary minus"</span> NONA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> mkumin _loc <span class="string">"-"</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-."</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> mkumin _loc <span class="string">"-."</span> e <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"assert"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> mkassert _loc e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"new"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">new</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"lazy"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">lazy</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"label"</span> NONA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>

        <span class="comment">(* Here it's LABEL and not tilde_label since ~a:b is different than ~a : b *)</span>
        <span class="tuareg-font-lock-operator">|</span> `LABEL i<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>

        <span class="comment">(* Same remark for ?a:b *)</span>
        <span class="tuareg-font-lock-operator">|</span> `OPTLABEL i<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>

        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"."</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> .<span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> .<span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> comma_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> bigarray_get _loc e1 e2
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$</span> . <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> lab <span class="tuareg-font-lock-operator">=</span> label <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>lab<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"~-"</span> NONA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"!"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$.</span><span class="tuareg-font-lock-governing">val</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> f <span class="tuareg-font-lock-operator">=</span> prefixop<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>f<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.expr_tag
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"exp"</span><span class="tuareg-font-lock-operator">|</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"expr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"`bool"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"tup"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>tup<span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"expr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"seq"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">do</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"expr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="keyword">done</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT32 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT64 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_NATIVEINT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_FLOAT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_STRING <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>str<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_CHAR <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>chr<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> TRY module_longident_dot_lparen<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">open</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-governing">in</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">e</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> TRY val_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> ` <span class="tuareg-font-lock-operator">$</span>s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> mk_list <span class="tuareg-font-lock-operator">=</span> sem_expr_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"::"</span><span class="tuareg-font-lock-operator">;</span> last <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk_list last
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> mk_list <span class="tuareg-font-lock-operator">=</span> sem_expr_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk_list <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[|"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"|]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[|"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> sem_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"|]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>el<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> label_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>el<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"with"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> label_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$)</span> <span class="keyword">with</span> <span class="tuareg-font-lock-operator">$</span>el<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{&lt;"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{&lt;&gt;}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{&lt;"</span><span class="tuareg-font-lock-operator">;</span> fel <span class="tuareg-font-lock-operator">=</span> field_expr_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{&lt;</span> <span class="tuareg-font-lock-operator">$</span>fel<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> comma_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>el<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> seq <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> mksequence _loc <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>seq<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> mksequence _loc e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">":&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":&gt;"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"begin"</span><span class="tuareg-font-lock-operator">;</span> seq <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span> mksequence _loc seq
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"begin"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">me</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> pt <span class="tuareg-font-lock-operator">=</span> package_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">me</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">pt</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">do_sequence</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> seq <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span><span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> seq <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> seq<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> seq
        <span class="tuareg-font-lock-operator">|</span> TRY <span class="tuareg-font-lock-operator">[</span><span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> seq <span class="tuareg-font-lock-operator">=</span> TRY <span class="tuareg-font-lock-operator">[</span>seq <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">;</span> <span class="string">"done"</span> <span class="tuareg-font-lock-operator">-&gt;</span> seq<span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> seq
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"done"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">infixop5</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"&amp;"</span> <span class="tuareg-font-lock-operator">|</span> <span class="string">"&amp;&amp;"</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">infixop6</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"or"</span> <span class="tuareg-font-lock-operator">|</span> <span class="string">"||"</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sem_expr_for_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>el acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">comma_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"expr,"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"top"</span> <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">dummy</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sequence</span><span class="tuareg-font-lock-operator">':</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">e </span><span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">e </span><span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> sequence <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">e </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>el<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sequence</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> rf <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> k <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            k <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">rf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> rf <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">rf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">mksequence _loc el</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding0<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> k <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            k <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> mb <span class="tuareg-font-lock-operator">=</span> module_binding0<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> el <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>mb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">$</span>mksequence _loc el<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"open"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> module_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">open</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">e</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"expr;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> k <span class="tuareg-font-lock-operator">=</span> sequence<span class="tuareg-font-lock-operator">'</span> <span class="tuareg-font-lock-operator">-&gt;</span> k e <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">binding</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"binding"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> b1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> b2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>b1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">b2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> b <span class="tuareg-font-lock-operator">=</span> let_binding <span class="tuareg-font-lock-operator">-&gt;</span> b
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">let_binding</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> ipatt<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> fun_binding <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">fun_binding</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> TRY <span class="tuareg-font-lock-operator">[</span><span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">];</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">type</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> TRY labeled_ipatt<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">p</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> bi <span class="tuareg-font-lock-operator">=</span> cvalue_binding <span class="tuareg-font-lock-operator">-&gt;</span> bi
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">match_case</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> LIST0 match_case0 SEP <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.mcOr_of_list l
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> ipatt<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">match_case0</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"match_case"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"match_case"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"match_case"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"when"</span><span class="tuareg-font-lock-operator">;</span> w <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="keyword">when</span> <span class="tuareg-font-lock-operator">$</span>w<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt_as_patt_opt<span class="tuareg-font-lock-operator">;</span> w <span class="tuareg-font-lock-operator">=</span> opt_when_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="keyword">when</span> <span class="tuareg-font-lock-operator">$</span>w<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_when_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"when"</span><span class="tuareg-font-lock-operator">;</span> w <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> w
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">patt_as_patt_opt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">as</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> p
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_expr_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> b1 <span class="tuareg-font-lock-operator">=</span> label_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> b2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>b1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">$</span>b2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> b1 <span class="tuareg-font-lock-operator">=</span> label_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span>            <span class="tuareg-font-lock-operator">-&gt;</span> b1
        <span class="tuareg-font-lock-operator">|</span> b1 <span class="tuareg-font-lock-operator">=</span> label_expr                 <span class="tuareg-font-lock-operator">-&gt;</span> b1
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">label_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"rec_binding"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"rec_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"rec_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"rec_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> label_longident<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> fun_binding <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> label_longident <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">lid_of_ident i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">fun_def</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> TRY <span class="tuareg-font-lock-operator">[</span><span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">];</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span>
          e <span class="tuareg-font-lock-operator">=</span> fun_def_cont_no_when <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">type</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> TRY labeled_ipatt<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>w<span class="tuareg-font-lock-operator">,</span> e<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> fun_def_cont <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="keyword">when</span> <span class="tuareg-font-lock-operator">$</span>w<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">fun_def_cont</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> TRY <span class="tuareg-font-lock-operator">[</span><span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">];</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span>
          e <span class="tuareg-font-lock-operator">=</span> fun_def_cont_no_when <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">type</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> TRY labeled_ipatt<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>w<span class="tuareg-font-lock-operator">,</span>e<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="keyword">when</span> <span class="tuareg-font-lock-operator">$</span>w<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"when"</span><span class="tuareg-font-lock-operator">;</span> w <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>w<span class="tuareg-font-lock-operator">,</span> e<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;,</span> e<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">fun_def_cont_no_when</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> TRY <span class="tuareg-font-lock-operator">[</span><span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"type"</span><span class="tuareg-font-lock-operator">];</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span><span class="tuareg-font-lock-operator">;</span>
          e <span class="tuareg-font-lock-operator">=</span> fun_def_cont_no_when <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">type</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="variable-name">i</span><span class="tuareg-font-lock-operator">$)</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> TRY labeled_ipatt<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>w<span class="tuareg-font-lock-operator">,</span>e<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> fun_def_cont <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="keyword">when</span> <span class="tuareg-font-lock-operator">$</span>w<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> e <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">patt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"|"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">".."</span> NONA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">".."</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">..</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"lazy"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">lazy</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>  <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"pat"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"tup"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>tup<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"`bool"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT32 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_INT64 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_NATIVEINT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_FLOAT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_STRING <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>str<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_CHAR <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>chr<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_INT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_INT32 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int32<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_INT64 <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>int64<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_NATIVEINT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>nativeint<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_FLOAT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>flo<span class="tuareg-font-lock-operator">:</span><span class="type">neg_string s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> mk_list <span class="tuareg-font-lock-operator">=</span> sem_patt_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"::"</span><span class="tuareg-font-lock-operator">;</span> last <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk_list last
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> mk_list <span class="tuareg-font-lock-operator">=</span> sem_patt_for_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            mk_list <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[|"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"|]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[|"</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> sem_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"|]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[|</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> label_patt_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="keyword">as</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> comma_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"_"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.patt_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> s <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> ` <span class="tuareg-font-lock-operator">$</span>s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `LABEL i<span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n <span class="variable-name">i</span><span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `LIDENT i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="comment">(* | i = opt_label; "("; p = patt_tcon; ")" -&gt; *)</span>
            <span class="comment">(* &lt;:patt&lt; ? $i$ : ($p$) &gt;&gt; *)</span>
        <span class="tuareg-font-lock-operator">|</span> `OPTLABEL i<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt_tcon<span class="tuareg-font-lock-operator">;</span> f <span class="tuareg-font-lock-operator">=</span> eq_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> f i p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt_tcon<span class="tuareg-font-lock-operator">;</span> f <span class="tuareg-font-lock-operator">=</span> eq_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            f <span class="tuareg-font-lock-operator">(</span>mk_anti n i<span class="tuareg-font-lock-operator">)</span> p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `LIDENT i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt_tcon<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt_tcon<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">comma_patt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt,"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sem_patt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> p
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sem_patt_for_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>pl acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">::</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_patt_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> label_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p1 <span class="tuareg-font-lock-operator">=</span> label_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"_"</span>       <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p1 <span class="tuareg-font-lock-operator">=</span> label_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"_"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span>  <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p1 <span class="tuareg-font-lock-operator">=</span> label_patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span>            <span class="tuareg-font-lock-operator">-&gt;</span> p1
        <span class="tuareg-font-lock-operator">|</span> p1 <span class="tuareg-font-lock-operator">=</span> label_patt                 <span class="tuareg-font-lock-operator">-&gt;</span> p1
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">label_patt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"pat"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.patt_tag
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> label_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> label_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">lid_of_ident i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> label_ipatt_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"pat"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"tup"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>tup<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.patt_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="keyword">as</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> pl <span class="tuareg-font-lock-operator">=</span> comma_ipatt<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>pl<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"_"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">labeled_ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> ipatt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">comma_ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt,"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> ipatt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_ipatt_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p1 <span class="tuareg-font-lock-operator">=</span> label_ipatt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> p2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>p1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">$</span>p2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p1 <span class="tuareg-font-lock-operator">=</span> label_ipatt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span>            <span class="tuareg-font-lock-operator">-&gt;</span> p1
        <span class="tuareg-font-lock-operator">|</span> p1 <span class="tuareg-font-lock-operator">=</span> label_ipatt                 <span class="tuareg-font-lock-operator">-&gt;</span> p1
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">label_ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"pat"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"patt;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.patt_tag
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> label_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> ipatt <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctypand"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">t2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">(</span>n<span class="tuareg-font-lock-operator">,</span> tpl<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> type_ident_and_parameters<span class="tuareg-font-lock-operator">;</span> tk <span class="tuareg-font-lock-operator">=</span> opt_eq_ctyp<span class="tuareg-font-lock-operator">;</span>
          cl <span class="tuareg-font-lock-operator">=</span> LIST0 constrain <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.TyDcl _loc n tpl tk cl <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">constrain</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"constraint"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>t1<span class="tuareg-font-lock-operator">,</span> t2<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_eq_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> tk <span class="tuareg-font-lock-operator">=</span> type_kind <span class="tuareg-font-lock-operator">-&gt;</span> tk
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_kind</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_ident_and_parameters</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> tpl <span class="tuareg-font-lock-operator">=</span> LIST0 type_parameter <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> tpl<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_longident_and_parameters</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> type_longident<span class="tuareg-font-lock-operator">;</span> tpl <span class="tuareg-font-lock-operator">=</span> type_parameters <span class="tuareg-font-lock-operator">-&gt;</span> tpl <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_parameters</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> type_parameter<span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> t2 <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> type_parameter <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">acc </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>acc<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">t </span><span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_parameter</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">'$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"+"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">+'$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">-'$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"=="</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"=="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">==</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"private"</span> NONA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"private"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp LEVEL <span class="string">"alias"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">private</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"alias"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="keyword">as</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"forall"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"!"</span><span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> typevars<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">!</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> . <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"arrow"</span> RIGHTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"label"</span> NONA
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LABEL<span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span>  SELF  <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_OPTLABEL<span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">t </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-governing">in</span>
            <span class="keyword">try</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">Ast.ident_of_ctyp t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
            <span class="keyword">with</span> <span class="tuareg-font-lock-operator">[</span> Invalid_argument _ <span class="tuareg-font-lock-operator">-&gt;</span> t <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"."</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">try</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">Ast.ident_of_ctyp t1</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">id</span><span class="tuareg-font-lock-operator">:</span><span class="type">Ast</span>.ident_of_ctyp t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
            <span class="keyword">with</span> <span class="tuareg-font-lock-operator">[</span> Invalid_argument s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error s<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">'$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"_"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> _ <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"tup"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>tup<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"id"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"*"</span><span class="tuareg-font-lock-operator">;</span> tl <span class="tuareg-font-lock-operator">=</span> star_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">*</span> <span class="tuareg-font-lock-operator">$</span>tl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_declarations<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&lt;"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&lt;"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> ntl <span class="tuareg-font-lock-operator">=</span> name_tags<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$</span>ntl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[&lt;"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"[&lt;"</span><span class="tuareg-font-lock-operator">;</span> rfl <span class="tuareg-font-lock-operator">=</span> row_field<span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span><span class="tuareg-font-lock-operator">;</span> ntl <span class="tuareg-font-lock-operator">=</span> name_tags<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>rfl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;</span> <span class="tuareg-font-lock-operator">$</span>ntl<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"{"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> label_declaration_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"}"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">{</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">}</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"&lt;"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> opt_meth_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"&gt;"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"module"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> package_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">(</span><span class="tuareg-font-lock-governing">module</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">star_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp*"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"*"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">*</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">constructor_declarations</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp|"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_arg_list <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">of</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">constructor_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> constructor_arg_list <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">of</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">constructor_arg_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctypand"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">t2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_declaration_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> label_declaration<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> label_declaration<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span>            <span class="tuareg-font-lock-operator">-&gt;</span> t1
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> label_declaration                 <span class="tuareg-font-lock-operator">-&gt;</span> t1
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>  <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> s <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"mutable"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="keyword">mutable</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_ident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> i
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> i <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$.$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">j</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">m</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_longident_with_app</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"apply"</span>
        <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"."</span>
        <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$.$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> i <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_longident_dot_lparen</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">m</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"apply"</span>
        <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"."</span>
        <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$.$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> i <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">m</span><span class="tuareg-font-lock-operator">$.$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> type_longident <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">val_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> ident <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_longident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> label_longident <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> c1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> c2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>c1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">c2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"cdcl"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_expr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_expr_tag
        <span class="tuareg-font-lock-operator">|</span> ci <span class="tuareg-font-lock-operator">=</span> class_info_for_class_expr<span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> class_fun_binding <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ci<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>ce<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_fun_binding</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> class_expr <span class="tuareg-font-lock-operator">-&gt;</span> ce
        <span class="tuareg-font-lock-operator">|</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> class_type_plus<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> class_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>ce<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">ct</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> labeled_ipatt<span class="tuareg-font-lock-operator">;</span> cfb <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">p</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>cfb<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_info_for_class_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> mv <span class="tuareg-font-lock-operator">=</span> opt_virtual<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> ot<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> class_name_and_param <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>virtual<span class="tuareg-font-lock-operator">:</span><span class="type">mv</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">lid</span><span class="tuareg-font-lock-operator">:</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>ot<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_info_for_class_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> mv <span class="tuareg-font-lock-operator">=</span> opt_virtual<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> ot<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> class_name_and_param <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>virtual<span class="tuareg-font-lock-operator">:</span><span class="type">mv</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">lid</span><span class="tuareg-font-lock-operator">:</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>ot<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_name_and_param</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> comma_type_parameter<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> x<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;)</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">comma_type_parameter</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp,"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> type_parameter <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_comma_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> comma_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">comma_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp,"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_fun_def</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> labeled_ipatt<span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">p</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ce<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> class_expr <span class="tuareg-font-lock-operator">-&gt;</span> ce <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"top"</span>
        <span class="tuareg-font-lock-operator">[</span> <span class="string">"fun"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> labeled_ipatt<span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> class_fun_def <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">fun</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">p</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ce<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"let"</span><span class="tuareg-font-lock-operator">;</span> rf <span class="tuareg-font-lock-operator">=</span> opt_rec<span class="tuareg-font-lock-operator">;</span> bi <span class="tuareg-font-lock-operator">=</span> binding<span class="tuareg-font-lock-operator">;</span> <span class="string">"in"</span><span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">rec</span><span class="tuareg-font-lock-operator">:</span><span class="type">rf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">bi</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-governing">in</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">ce</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"apply"</span> NONA
        <span class="tuareg-font-lock-operator">[</span> ce <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr LEVEL <span class="string">"label"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ce<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"cexp"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_expr"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_expr_tag
        <span class="tuareg-font-lock-operator">|</span> ce <span class="tuareg-font-lock-operator">=</span> class_longident_and_param <span class="tuareg-font-lock-operator">-&gt;</span> ce
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"object"</span><span class="tuareg-font-lock-operator">;</span> csp <span class="tuareg-font-lock-operator">=</span> opt_class_self_patt<span class="tuareg-font-lock-operator">;</span> cst <span class="tuareg-font-lock-operator">=</span> class_structure<span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">object</span> <span class="tuareg-font-lock-operator">($</span>csp<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">$</span>cst<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">end</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> class_type<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>ce<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">ct</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> ce <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_longident_and_param</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> ci <span class="tuareg-font-lock-operator">=</span> class_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> comma_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">ci</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ci <span class="tuareg-font-lock-operator">=</span> class_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">ci</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_structure</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"cst"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_str_item"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"cst"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> cst <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_str_item"</span> n s<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>cst<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> l <span class="tuareg-font-lock-operator">=</span> LIST0 <span class="tuareg-font-lock-operator">[</span> cst <span class="tuareg-font-lock-operator">=</span> class_str_item<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span> cst <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.crSem_of_list l
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_class_self_patt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_str_item</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"cst"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_str_item"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_str_item_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"inherit"</span><span class="tuareg-font-lock-operator">;</span> o <span class="tuareg-font-lock-operator">=</span> opt_override<span class="tuareg-font-lock-operator">;</span> ce <span class="tuareg-font-lock-operator">=</span> class_expr<span class="tuareg-font-lock-operator">;</span> pb <span class="tuareg-font-lock-operator">=</span> opt_as_lident <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">inherit</span> <span class="tuareg-font-lock-operator">$</span><span class="type">override</span><span class="tuareg-font-lock-operator">:</span><span class="type">o</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">ce</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="keyword">as</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">pb</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> o <span class="tuareg-font-lock-operator">=</span> value_val_opt_override<span class="tuareg-font-lock-operator">;</span> mf <span class="tuareg-font-lock-operator">=</span> opt_mutable<span class="tuareg-font-lock-operator">;</span> lab <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> cvalue_binding <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-operator">$</span>override<span class="tuareg-font-lock-operator">:</span><span class="type">o</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">mutable</span><span class="tuareg-font-lock-operator">:</span>mf<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>lab<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> o <span class="tuareg-font-lock-operator">=</span> value_val_opt_override<span class="tuareg-font-lock-operator">;</span> mf <span class="tuareg-font-lock-operator">=</span> opt_mutable<span class="tuareg-font-lock-operator">;</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">if</span> o <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="keyword">then</span>
              <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error <span class="string">"override (!) is incompatible with virtual"</span><span class="tuareg-font-lock-operator">)</span>
            <span class="keyword">else</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-governing">virtual</span> <span class="tuareg-font-lock-operator">$</span>mutable<span class="tuareg-font-lock-operator">:</span><span class="type">mf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> o <span class="tuareg-font-lock-operator">=</span> value_val_opt_override<span class="tuareg-font-lock-operator">;</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> mf <span class="tuareg-font-lock-operator">=</span> opt_mutable<span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">if</span> o <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="keyword">then</span>
              <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error <span class="string">"override (!) is incompatible with virtual"</span><span class="tuareg-font-lock-operator">)</span>
            <span class="keyword">else</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-governing">virtual</span> <span class="tuareg-font-lock-operator">$</span>mutable<span class="tuareg-font-lock-operator">:</span><span class="type">mf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> o <span class="tuareg-font-lock-operator">=</span> method_opt_override<span class="tuareg-font-lock-operator">;</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> pf <span class="tuareg-font-lock-operator">=</span> opt_private<span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">if</span> o <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="keyword">then</span>
              <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error <span class="string">"override (!) is incompatible with virtual"</span><span class="tuareg-font-lock-operator">)</span>
            <span class="keyword">else</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">method</span> <span class="tuareg-font-lock-governing">virtual</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="function-name">private</span><span class="tuareg-font-lock-operator">:</span><span class="type">pf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> o <span class="tuareg-font-lock-operator">=</span> method_opt_override<span class="tuareg-font-lock-operator">;</span> pf <span class="tuareg-font-lock-operator">=</span> opt_private<span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> topt <span class="tuareg-font-lock-operator">=</span> opt_polyt<span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> fun_binding <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">method</span> <span class="tuareg-font-lock-operator">$</span><span class="function-name">override</span><span class="tuareg-font-lock-operator">:</span><span class="type">o</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">private</span><span class="tuareg-font-lock-operator">:</span>pf<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>l<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">topt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> o <span class="tuareg-font-lock-operator">=</span> method_opt_override<span class="tuareg-font-lock-operator">;</span> pf <span class="tuareg-font-lock-operator">=</span> opt_private<span class="tuareg-font-lock-operator">;</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">if</span> o <span class="tuareg-font-lock-operator">&lt;&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="keyword">then</span>
              <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error <span class="string">"override (!) is incompatible with virtual"</span><span class="tuareg-font-lock-operator">)</span>
            <span class="keyword">else</span>
              <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">method</span> <span class="tuareg-font-lock-governing">virtual</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="function-name">private</span><span class="tuareg-font-lock-operator">:</span><span class="type">pf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> type_constraint<span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"initializer"</span><span class="tuareg-font-lock-operator">;</span> se <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">initializer</span> <span class="tuareg-font-lock-operator">$</span>se<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">method_opt_override</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"method"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"!"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">!</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"method"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">((</span><span class="string">"!"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"override"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">)</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.OvAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"method"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">value_val_opt_override</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> value_val<span class="tuareg-font-lock-operator">;</span> <span class="string">"!"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">!</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> value_val<span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">((</span><span class="string">"!"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"override"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">)</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.OvAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> value_val <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_as_lident</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"as"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> i
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="string">""</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_polyt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span> t
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">cvalue_binding</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type<span class="tuareg-font-lock-operator">;</span> <span class="string">":&gt;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="keyword">match</span> t <span class="keyword">with</span>
            <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">!</span> <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> . <span class="tuareg-font-lock-operator">$</span>_<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">raise</span> <span class="tuareg-font-lock-operator">(</span><span class="type">Stream</span>.Error <span class="string">"unexpected polytype here"</span><span class="tuareg-font-lock-operator">)</span>
            <span class="tuareg-font-lock-operator">|</span> _ <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:&gt;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">":&gt;"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">label</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> i <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"ctyp"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_type"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_type_tag
        <span class="tuareg-font-lock-operator">|</span> ct <span class="tuareg-font-lock-operator">=</span> class_type_longident_and_param <span class="tuareg-font-lock-operator">-&gt;</span> ct
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"object"</span><span class="tuareg-font-lock-operator">;</span> cst <span class="tuareg-font-lock-operator">=</span> opt_class_self_type<span class="tuareg-font-lock-operator">;</span> csg <span class="tuareg-font-lock-operator">=</span> class_signature<span class="tuareg-font-lock-operator">;</span> <span class="string">"end"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">object</span> <span class="tuareg-font-lock-operator">($</span>cst<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">$</span>csg<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">end</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_longident_and_param</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> class_type_longident<span class="tuareg-font-lock-operator">;</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> comma_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> class_type_longident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>id<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_plus</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"["</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"]"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"-&gt;"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">$</span>ct<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ct <span class="tuareg-font-lock-operator">=</span> class_type <span class="tuareg-font-lock-operator">-&gt;</span> ct <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_class_self_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> t
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_signature</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"csg"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_sig_item"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"csg"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> csg <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_sig_item"</span> n s<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>csg<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> l <span class="tuareg-font-lock-operator">=</span> LIST0 <span class="tuareg-font-lock-operator">[</span> csg <span class="tuareg-font-lock-operator">=</span> class_sig_item<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span> csg <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.cgSem_of_list l
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_sig_item</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"csg"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_sig_item"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_sig_item_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"inherit"</span><span class="tuareg-font-lock-operator">;</span> cs <span class="tuareg-font-lock-operator">=</span> class_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">inherit</span> <span class="tuareg-font-lock-operator">$</span><span class="type">cs</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> value_val<span class="tuareg-font-lock-operator">;</span> mf <span class="tuareg-font-lock-operator">=</span> opt_mutable<span class="tuareg-font-lock-operator">;</span> mv <span class="tuareg-font-lock-operator">=</span> opt_virtual<span class="tuareg-font-lock-operator">;</span>
          l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> value <span class="tuareg-font-lock-operator">$</span>mutable<span class="tuareg-font-lock-operator">:</span><span class="type">mf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">virtual</span><span class="tuareg-font-lock-operator">:</span>mv<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>l<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"method"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> pf <span class="tuareg-font-lock-operator">=</span> opt_private<span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">method</span> <span class="tuareg-font-lock-governing">virtual</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="function-name">private</span><span class="tuareg-font-lock-operator">:</span><span class="type">pf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"method"</span><span class="tuareg-font-lock-operator">;</span> pf <span class="tuareg-font-lock-operator">=</span> opt_private<span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">method</span> <span class="tuareg-font-lock-operator">$</span><span class="function-name">private</span><span class="tuareg-font-lock-operator">:</span><span class="type">pf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"method"</span><span class="tuareg-font-lock-operator">;</span> pf <span class="tuareg-font-lock-operator">=</span> opt_private<span class="tuareg-font-lock-operator">;</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">method</span> <span class="tuareg-font-lock-governing">virtual</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">$</span><span class="function-name">private</span><span class="tuareg-font-lock-operator">:</span><span class="type">pf</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> type_constraint<span class="tuareg-font-lock-operator">;</span> t1 <span class="tuareg-font-lock-operator">=</span> ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">type</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t1</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">type_constraint</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"type"</span> <span class="tuareg-font-lock-operator">|</span> <span class="string">"constraint"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_description</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> cd1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> cd2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>cd1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">cd2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_type"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_type_tag
        <span class="tuareg-font-lock-operator">|</span> ci <span class="tuareg-font-lock-operator">=</span> class_info_for_class_type<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> class_type_plus <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ci<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">ct</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_declaration</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> cd1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> cd2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>cd1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">cd2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_type"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.class_type_tag
        <span class="tuareg-font-lock-operator">|</span> ci <span class="tuareg-font-lock-operator">=</span> class_info_for_class_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> ct <span class="tuareg-font-lock-operator">=</span> class_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ci<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>ct<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">field_expr_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> b1 <span class="tuareg-font-lock-operator">=</span> field_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> b2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>b1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">$</span>b2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> b1 <span class="tuareg-font-lock-operator">=</span> field_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span>            <span class="tuareg-font-lock-operator">-&gt;</span> b1
        <span class="tuareg-font-lock-operator">|</span> b1 <span class="tuareg-font-lock-operator">=</span> field_expr                 <span class="tuareg-font-lock-operator">-&gt;</span> b1
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">field_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"bi"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"rec_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"rec_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> l <span class="tuareg-font-lock-operator">=</span> label<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">l</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">meth_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> m <span class="tuareg-font-lock-operator">=</span> meth_decl<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>ml<span class="tuareg-font-lock-operator">,</span> v<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> SELF  <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>m<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>ml<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;,</span> v<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> meth_decl<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> v <span class="tuareg-font-lock-operator">=</span> opt_dot_dot <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>m<span class="tuareg-font-lock-operator">,</span> v<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> meth_decl<span class="tuareg-font-lock-operator">;</span> v <span class="tuareg-font-lock-operator">=</span> opt_dot_dot      <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">(</span>m<span class="tuareg-font-lock-operator">,</span> v<span class="tuareg-font-lock-operator">)</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">meth_decl</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s        <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s          <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x                       <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> lab <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> poly_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">lab</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_meth_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">(</span>ml<span class="tuareg-font-lock-operator">,</span> v<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> meth_list <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ml<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$.</span>.<span class="tuareg-font-lock-operator">:</span><span class="type">v</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> v <span class="tuareg-font-lock-operator">=</span> opt_dot_dot     <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$.</span>.<span class="tuareg-font-lock-operator">:</span><span class="type">v</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">poly_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">package_type</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">typevars</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> LEFTA
        <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `QUOTATION x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Quotation</span>.expand _loc x <span class="type">Quotation</span>.<span class="type">DynAst</span>.ctyp_tag
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"'"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">'$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">row_field</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp|"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&amp;"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> amp_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">of</span> <span class="tuareg-font-lock-operator">&amp;</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> amp_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">of</span> <span class="tuareg-font-lock-operator">$</span>t<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">amp_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"&amp;"</span><span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&amp;</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp&amp;"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> t
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">name_tags</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"typ"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ctyp"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> t1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> t2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>t1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>t2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">eq_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">i p </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="keyword">fun</span> <span class="variable-name">i p </span><span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">($</span><span class="type">p</span><span class="tuareg-font-lock-operator">$)</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">patt_tcon</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ipatt</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `LABEL i<span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n <span class="variable-name">i</span><span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">p</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `LIDENT i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">~</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="comment">(* | i = opt_label; "("; p = ipatt_tcon; ")" -&gt;
            &lt;:patt&lt; ? $i$ : ($p$) &gt;&gt;
        | i = opt_label; "("; p = ipatt_tcon; "="; e = expr; ")" -&gt;
            &lt;:patt&lt; ? $i$ : ($p$ = $e$) &gt;&gt;                             *)</span>
        <span class="tuareg-font-lock-operator">|</span> `OPTLABEL i<span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> ipatt_tcon<span class="tuareg-font-lock-operator">;</span> f <span class="tuareg-font-lock-operator">=</span> eq_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> f i p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> ipatt_tcon<span class="tuareg-font-lock-operator">;</span>
          f <span class="tuareg-font-lock-operator">=</span> eq_expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> f <span class="tuareg-font-lock-operator">(</span>mk_anti n i<span class="tuareg-font-lock-operator">)</span> p
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `LIDENT i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> i <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> ipatt_tcon<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> p <span class="tuareg-font-lock-operator">=</span> ipatt_tcon<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> e <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">?</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>e<span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ipatt_tcon</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> p <span class="tuareg-font-lock-operator">=</span> ipatt<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> t <span class="tuareg-font-lock-operator">=</span> ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">($</span>p<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">t</span><span class="tuareg-font-lock-operator">$)</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">=</span> ipatt <span class="tuareg-font-lock-operator">-&gt;</span> p <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">direction_flag</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"to"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">direction_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">to</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"downto"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">direction_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">downto</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"to"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.DiAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_private</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"private"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">private_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">private</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"private"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.PrAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">private_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_mutable</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"mutable"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">mutable_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">mutable</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"mutable"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.MuAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">mutable_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_virtual</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"virtual"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">virtual_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">virtual</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"virtual"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.ViAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">virtual_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_dot_dot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">".."</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">row_var_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">..</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">".."</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.RvAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">row_var_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_rec</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"rec"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">rec</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"rec"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.ReAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_override</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"!"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">!</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">((</span><span class="string">"!"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"override"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">)</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.OvAnt <span class="tuareg-font-lock-operator">(</span>mk_anti n s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">override_flag</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">opt_expr</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">interf</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">([</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">],</span> stopped_at _loc<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> si <span class="tuareg-font-lock-operator">=</span> sig_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>sil<span class="tuareg-font-lock-operator">,</span> stopped<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">([</span>si <span class="tuareg-font-lock-operator">::</span> sil<span class="tuareg-font-lock-operator">],</span> stopped<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">([],</span> None<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sig_items</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"sigi"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"sig_item"</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"sigi"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> sg <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"sig_item"</span> s<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>sg<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> l <span class="tuareg-font-lock-operator">=</span> LIST0 <span class="tuareg-font-lock-operator">[</span> sg <span class="tuareg-font-lock-operator">=</span> sig_item<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span> sg <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.sgSem_of_list l
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">implem</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">([</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">],</span> stopped_at _loc<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> si <span class="tuareg-font-lock-operator">=</span> str_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>sil<span class="tuareg-font-lock-operator">,</span> stopped<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">([</span>si <span class="tuareg-font-lock-operator">::</span> sil<span class="tuareg-font-lock-operator">],</span> stopped<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">([],</span> None<span class="tuareg-font-lock-operator">)</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">str_items</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"stri"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"str_item"</span> s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"stri"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> st <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti n </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"str_item"</span> s<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>st<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> l <span class="tuareg-font-lock-operator">=</span> LIST0 <span class="tuareg-font-lock-operator">[</span> st <span class="tuareg-font-lock-operator">=</span> str_item<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span> st <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.stSem_of_list l
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">top_phrase</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> ph <span class="tuareg-font-lock-operator">=</span> phrase <span class="tuareg-font-lock-operator">-&gt;</span> Some ph
        <span class="tuareg-font-lock-operator">|</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> None
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">use_file</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">([</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">],</span> stopped_at _loc<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> si <span class="tuareg-font-lock-operator">=</span> str_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>sil<span class="tuareg-font-lock-operator">,</span> stopped<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">([</span>si <span class="tuareg-font-lock-operator">::</span> sil<span class="tuareg-font-lock-operator">],</span> stopped<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">([],</span> None<span class="tuareg-font-lock-operator">)</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">phrase</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> st <span class="tuareg-font-lock-operator">=</span> str_item<span class="tuareg-font-lock-operator">;</span> semi <span class="tuareg-font-lock-operator">-&gt;</span> st
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_INT</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"int"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`int"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `INT _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_INT32</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"int32"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`int32"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `INT32 _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_INT64</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"int64"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`int64"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `INT64 _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_NATIVEINT</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"nativeint"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`nativeint"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `NATIVEINT _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_FLOAT</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"flo"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`flo"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `FLOAT _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_CHAR</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"chr"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`chr"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `CHAR _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_UIDENT</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"uid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `UIDENT s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_LIDENT</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"lid"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `LIDENT s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_LABEL</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"~"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span> <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `LABEL s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_OPTLABEL</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"?"</span><span class="tuareg-font-lock-operator">;</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span> <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `OPTLABEL s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">a_STRING</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"str"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"`str"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> mk_anti n s
        <span class="tuareg-font-lock-operator">|</span> `STRING _ s <span class="tuareg-font-lock-operator">-&gt;</span> s <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">string_list</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"str_list"</span><span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.LAnt <span class="tuareg-font-lock-operator">(</span>mk_anti <span class="string">"str_list"</span> s<span class="tuareg-font-lock-operator">)</span>
        <span class="tuareg-font-lock-operator">|</span> `STRING _ x<span class="tuareg-font-lock-operator">;</span> xs <span class="tuareg-font-lock-operator">=</span> string_list <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.LCons x xs
        <span class="tuareg-font-lock-operator">|</span> `STRING _ x <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.LCons x <span class="type">Ast</span>.LNil <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">value_let</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"value"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">value_val</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"value"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">semi</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">";"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">()</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">expr_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> e1 <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> comma_expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e1 <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> e2 <span class="tuareg-font-lock-operator">=</span> sem_expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>e1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>e2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> e <span class="tuareg-font-lock-operator">=</span> expr <span class="tuareg-font-lock-operator">-&gt;</span> e
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">patt_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> comma_patt <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> sem_patt <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">i </span><span class="tuareg-font-lock-operator">=</span>
              <span class="keyword">match</span> x <span class="keyword">with</span>
              <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">@</span>loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">-&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">@</span>loc<span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">s</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
              <span class="tuareg-font-lock-operator">|</span> p <span class="tuareg-font-lock-operator">-&gt;</span> <span class="type">Ast</span>.ident_of_patt p <span class="tuareg-font-lock-operator">]</span>
            <span class="tuareg-font-lock-governing">in</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> patt <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">patt</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ctyp_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">","</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> comma_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$,</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> label_declaration_list <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> constructor_declarations <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> constructor_arg_list <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">of</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> constructor_arg_list<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> z <span class="tuareg-font-lock-operator">=</span> constructor_declarations <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">of</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>z<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&amp;"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> amp_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">of</span> <span class="tuareg-font-lock-operator">&amp;</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"of"</span><span class="tuareg-font-lock-operator">;</span> <span class="string">"&amp;"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> amp_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"|"</span><span class="tuareg-font-lock-operator">;</span> z <span class="tuareg-font-lock-operator">=</span> row_field <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">of</span> <span class="tuareg-font-lock-operator">&amp;</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">$</span>z<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> more_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">y</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">";"</span><span class="tuareg-font-lock-operator">;</span> z <span class="tuareg-font-lock-operator">=</span> label_declaration_list <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">y</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">$</span>z<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"*"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> star_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">*</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"&amp;"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> amp_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&amp;</span> <span class="tuareg-font-lock-operator">$</span>y<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> y <span class="tuareg-font-lock-operator">=</span> constructor_arg_list <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">y</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> more_ctyp <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">more_ctyp</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"mutable"</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="keyword">mutable</span> <span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"`"</span><span class="tuareg-font-lock-operator">;</span> x <span class="tuareg-font-lock-operator">=</span> a_ident <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ctyp</span><span class="tuareg-font-lock-operator">&lt;</span> `<span class="tuareg-font-lock-operator">$</span>x<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> type_kind <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> type_parameter <span class="tuareg-font-lock-operator">-&gt;</span> x
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">str_item_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> st1 <span class="tuareg-font-lock-operator">=</span> str_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> st2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>st1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>st2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> st <span class="tuareg-font-lock-operator">=</span> str_item <span class="tuareg-font-lock-operator">-&gt;</span> st
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">str_item</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">sig_item_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> <span class="string">"#"</span><span class="tuareg-font-lock-operator">;</span> n <span class="tuareg-font-lock-operator">=</span> a_LIDENT<span class="tuareg-font-lock-operator">;</span> dp <span class="tuareg-font-lock-operator">=</span> opt_expr <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">#</span> <span class="tuareg-font-lock-operator">$</span>n<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>dp<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> sg1 <span class="tuareg-font-lock-operator">=</span> sig_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> sg2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>sg1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>sg2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> sg <span class="tuareg-font-lock-operator">=</span> sig_item <span class="tuareg-font-lock-operator">-&gt;</span> sg
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">sig_item</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_type_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_type</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_expr_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">match_case_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> LIST0 match_case0 SEP <span class="string">"|"</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>list<span class="tuareg-font-lock-operator">:</span><span class="type">x</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">match_case</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">binding_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> binding <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">binding</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">rec_binding_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> label_expr_list <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">rec_binding</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">module_binding_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> b1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> b2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>b1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">b2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"module_binding"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"module_binding"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> m<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n <span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> m<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>mk_anti n <span class="variable-name">m</span><span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>m<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> m <span class="tuareg-font-lock-operator">=</span> a_UIDENT<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> mt <span class="tuareg-font-lock-operator">=</span> module_type<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> me <span class="tuareg-font-lock-operator">=</span> module_expr <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>m<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">mt</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>me<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">module_binding</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">ident_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="string">"apply"</span>
        <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"."</span>
        <span class="tuareg-font-lock-operator">[</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> j <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>i<span class="tuareg-font-lock-operator">$.$</span>j<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span>
      <span class="tuareg-font-lock-operator">|</span> <span class="string">"simple"</span>
        <span class="tuareg-font-lock-operator">[</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_UIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>uid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> i <span class="tuareg-font-lock-operator">=</span> a_LIDENT <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">""</span><span class="tuareg-font-lock-operator">|</span><span class="string">"id"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"anti"</span><span class="tuareg-font-lock-operator">|</span><span class="string">"list"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> <span class="string">"."</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">ident</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>anti<span class="tuareg-font-lock-operator">:</span><span class="type">mk_anti </span><span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"ident"</span> n s<span class="tuareg-font-lock-operator">$.$</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"("</span><span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">")"</span> <span class="tuareg-font-lock-operator">-&gt;</span> i
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_expr_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> ce1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> ce2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ce1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">ce2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ce1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> ce2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ce1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>ce2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> ot<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> class_name_and_param <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">virtual</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>ot<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"virtual"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> ident<span class="tuareg-font-lock-operator">;</span> ot <span class="tuareg-font-lock-operator">=</span> opt_comma_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">anti </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Ast</span>.ViAnt <span class="tuareg-font-lock-operator">(</span>mk_anti <span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_expr"</span> n s<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>virtual<span class="tuareg-font-lock-operator">:</span><span class="type">anti</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">id</span><span class="tuareg-font-lock-operator">:</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>ot<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> class_expr <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_expr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_type_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> ct1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"and"</span><span class="tuareg-font-lock-operator">;</span> ct2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ct1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-governing">and</span> <span class="tuareg-font-lock-operator">$</span><span class="variable-name">ct2</span><span class="tuareg-font-lock-operator">$</span><span class="variable-name"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ct1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">"="</span><span class="tuareg-font-lock-operator">;</span> ct2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ct1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">=</span> <span class="tuareg-font-lock-operator">$</span>ct2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> ct1 <span class="tuareg-font-lock-operator">=</span> SELF<span class="tuareg-font-lock-operator">;</span> <span class="string">":"</span><span class="tuareg-font-lock-operator">;</span> ct2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>ct1<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">$</span><span class="type">ct2</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> <span class="string">"virtual"</span><span class="tuareg-font-lock-operator">;</span> <span class="tuareg-font-lock-operator">(</span>i<span class="tuareg-font-lock-operator">,</span> ot<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-operator">=</span> class_name_and_param <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-governing">virtual</span> <span class="tuareg-font-lock-operator">$</span>lid<span class="tuareg-font-lock-operator">:</span><span class="type">i</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>ot<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> `ANTIQUOT <span class="tuareg-font-lock-operator">(</span><span class="string">"virtual"</span> <span class="keyword">as</span> n<span class="tuareg-font-lock-operator">)</span> s<span class="tuareg-font-lock-operator">;</span> i <span class="tuareg-font-lock-operator">=</span> ident<span class="tuareg-font-lock-operator">;</span> ot <span class="tuareg-font-lock-operator">=</span> opt_comma_ctyp <span class="tuareg-font-lock-operator">-&gt;</span>
            <span class="tuareg-font-lock-governing">let</span> <span class="variable-name">anti </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Ast</span>.ViAnt <span class="tuareg-font-lock-operator">(</span>mk_anti <span class="tuareg-font-lock-operator">~</span><span class="variable-name">c</span><span class="tuareg-font-lock-operator">:</span><span class="string">"class_type"</span> n s<span class="tuareg-font-lock-operator">)</span> <span class="tuareg-font-lock-governing">in</span>
            <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>virtual<span class="tuareg-font-lock-operator">:</span><span class="type">anti</span><span class="tuareg-font-lock-operator">$</span><span class="type"> </span><span class="tuareg-font-lock-operator">$</span><span class="type">id</span><span class="tuareg-font-lock-operator">:</span>i<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">$</span>ot<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> class_type_plus <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_type</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span>
      <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_str_item_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x1 <span class="tuareg-font-lock-operator">=</span> class_str_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> x2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span>
          <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>x2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> class_str_item <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_str_item</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">class_sig_item_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x1 <span class="tuareg-font-lock-operator">=</span> class_sig_item<span class="tuareg-font-lock-operator">;</span> semi<span class="tuareg-font-lock-operator">;</span> x2 <span class="tuareg-font-lock-operator">=</span> SELF <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;</span> <span class="tuareg-font-lock-operator">$</span>x1<span class="tuareg-font-lock-operator">$;</span> <span class="tuareg-font-lock-operator">$</span>x2<span class="tuareg-font-lock-operator">$</span> <span class="tuareg-font-lock-operator">&gt;&gt;</span>
        <span class="tuareg-font-lock-operator">|</span> x <span class="tuareg-font-lock-operator">=</span> class_sig_item <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">class_sig_item</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">with_constr_quot</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> with_constr <span class="tuareg-font-lock-operator">-&gt;</span> x
        <span class="tuareg-font-lock-operator">|</span> <span class="tuareg-font-lock-operator">-&gt;</span> <span class="tuareg-font-lock-operator">&lt;:</span><span class="type">with_constr</span><span class="tuareg-font-lock-operator">&lt;&gt;&gt;</span> <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">rec_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> opt_rec <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">direction_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> direction_flag <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">mutable_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> opt_mutable <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">private_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> opt_private <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">virtual_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> opt_virtual <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">row_var_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> opt_dot_dot <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">override_flag_quot</span><span class="tuareg-font-lock-operator">:</span> <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> opt_override <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">];</span>
    <span class="variable-name">patt_eoi</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> patt<span class="tuareg-font-lock-operator">;</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
    <span class="variable-name">expr_eoi</span><span class="tuareg-font-lock-operator">:</span>
      <span class="tuareg-font-lock-operator">[</span> <span class="tuareg-font-lock-operator">[</span> x <span class="tuareg-font-lock-operator">=</span> expr<span class="tuareg-font-lock-operator">;</span> `EOI <span class="tuareg-font-lock-operator">-&gt;</span> x <span class="tuareg-font-lock-operator">]</span> <span class="tuareg-font-lock-operator">]</span>
    <span class="tuareg-font-lock-operator">;</span>
  END<span class="tuareg-font-lock-operator">;</span>

<span class="tuareg-font-lock-governing">end</span><span class="tuareg-font-lock-operator">;</span>

<span class="tuareg-font-lock-governing">let</span> <span class="tuareg-font-lock-governing">module</span><span class="variable-name"> M </span><span class="tuareg-font-lock-operator">=</span> <span class="type">Register</span>.OCamlSyntaxExtension Id Make <span class="tuareg-font-lock-governing">in</span> <span class="tuareg-font-lock-operator">();</span>
</pre>
  </body>
</html>
